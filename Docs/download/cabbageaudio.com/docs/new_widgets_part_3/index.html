<!DOCTYPE html> <html lang=en> <head> <meta charset=utf-8> <meta http-equiv=X-UA-Compatible content="IE=edge"> <meta name=viewport content="width=device-width, initial-scale=1"> <title>New Widgets Part 3 | Cabbage Audio</title> <meta name=description content="Cabbage is a framework for audio software development. Using simple markup text and the Csound audio synthesis language users can target four major operating..."> <link rel=canonical href="index.html"> <link rel=alternate type=application/rss+xml title="Cabbage Audio" href=http://cabbageaudio.com/feed.xml> <link rel=apple-touch-icon sizes=57x57 href=http://cabbageaudio.com/apple-touch-icon-57x57.png> <link rel=apple-touch-icon sizes=60x60 href=http://cabbageaudio.com/apple-touch-icon-60x60.png> <link rel=apple-touch-icon sizes=72x72 href=http://cabbageaudio.com/apple-touch-icon-72x72.png> <link rel=apple-touch-icon sizes=76x76 href=http://cabbageaudio.com/apple-touch-icon-76x76.png> <link rel=apple-touch-icon sizes=114x114 href=http://cabbageaudio.com/apple-touch-icon-114x114.png> <link rel=apple-touch-icon sizes=120x120 href=http://cabbageaudio.com/apple-touch-icon-120x120.png> <link rel=apple-touch-icon sizes=144x144 href=http://cabbageaudio.com/apple-touch-icon-144x144.png> <link rel=apple-touch-icon sizes=152x152 href=http://cabbageaudio.com/apple-touch-icon-152x152.png> <link rel=apple-touch-icon sizes=180x180 href=http://cabbageaudio.com/apple-touch-icon-180x180.png> <link rel=icon type=image/png href=http://cabbageaudio.com/favicon-32x32.png sizes=32x32> <link rel=icon type=image/png href=http://cabbageaudio.com/favicon-194x194.png sizes=194x194> <link rel=icon type=image/png href=http://cabbageaudio.com/favicon-96x96.png sizes=96x96> <link rel=icon type=image/png href=http://cabbageaudio.com/android-chrome-192x192.png sizes=192x192> <link rel=icon type=image/png href=http://cabbageaudio.com/favicon-16x16.png sizes=16x16> <link rel=manifest href=http://cabbageaudio.com/manifest.json> <link rel=mask-icon href=http://cabbageaudio.com/safari-pinned-tab.svg color=#93d200> <meta name=apple-mobile-web-app-title content="Cabbage Audio"> <meta name=application-name content="Cabbage Audio"> <meta name=msapplication-TileColor content=#24b1f2> <meta name=msapplication-TileImage content=http://cabbageaudio.com/mstile-144x144.png> <meta name=theme-color content=#0391d1> <link rel=stylesheet href="../../styles/main.css"> </head> <body class=docs> <div class=wrapper> <header class=navigation role=banner> <div class=navigation-wrapper> <a href="http://cabbageaudio.com/" class=logo-header> <img src="../../images/cabbage_transparent.svg" alt="Cabbage Logo"> </a> <a href=javascript:void(0) class=navigation-menu-button id=js-mobile-menu>MENU</a> <nav role=navigation> <ul id=js-navigation-menu class="navigation-menu show"> <li class=nav-link> <a href="http://cabbageaudio.com/" title=Home>Home</a> </li> <li class=nav-link> <a href=http://cabbageaudio.com/#features title=Features>Features</a> </li> <li class=nav-link> <a href="http://cabbageaudio.com/download/" title=Download>Download</a> </li> <li class="nav-link more"> <a href="http://cabbageaudio.com/" title=Learning>Learning</a> <ul class=submenu> <li> <a href="../introduction/index.html" title=Docs>Docs</a> </li> <li> <a href="http://cabbageaudio.com/tutorials/" title=Videos>Videos</a> </li> </ul> </li> <li class=nav-link> <a href="http://cabbageaudio.com/faq/" title=FAQ>FAQ</a> </li> <li class=nav-link> <a href=http://forum.cabbageaudio.com title=Forum target=_blank>Forum</a> </li> </ul> </nav> </div> </header> <!--[if lt IE 11]>
 <p class="browserupgrade">You are using an <strong>outdated</strong> browser. The CabbageAudio site may not display correctly. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
 <![endif]--> <aside class=doc-nav> <nav role=navigation id=doc-menu> <h3>Cabbage Docs</h3> <hr> <ul> <li> <a href=http://cabbageaudio.com/docs/intro class=sub-menu-trigger> <i class=icon-right-open></i>&nbsp; Quickstart </a> <ul class=submenu> <li><a href="../introduction/index.html">Introduction</a></li> <li><a href="../standalone_host/index.html">Standalone Host</a></li> <li><a href="../first_synth/index.html">First Synth</a></li> <li><a href="../controlling/index.html">Controlling</a></li> <li><a href="../first_effect/index.html">First Effect</a></li> <li><a href="../exporting/index.html">Exporting</a></li> <li><a href="../distributing/index.html">Distributing</a></li> <li><a href="../cabbage_studio/index.html">Cabbage Studio</a></li> <li><a href="../android/index.html">Android</a></li> <li><a href="../cabbage_audio_unit/index.html">Cabbage Audio Unit</a></li> </ul> </li> </ul> <ul> <li> <a href=http://cabbageaudio.com class=sub-menu-trigger> <i class=icon-right-open></i>&nbsp; Cabbage Widgets </a> <ul class=submenu> <li><a href="../cabbage_syntax/index.html">Cabbage Syntax</a></li> <li><a href="../button/index.html">Button</a></li> <li><a href="../button_file/index.html">Button File</a></li> <li><a href="../button_info/index.html">Button Info</a></li> <li><a href="../checkbox/index.html">Checkbox</a></li> <li><a href="../combobox/index.html">Combobox</a></li> <li><a href="../csound_output/index.html">Csound Output</a></li> <li><a href="../encoder/index.html">Encoder</a></li> <li><a href="../gentable/index.html">Gentable</a></li> <li><a href="../hrange/index.html">Hrange</a></li> <li><a href="../fftdisplay/index.html">Fftdisplay</a></li> <li><a href="../form/index.html">Form</a></li> <li><a href="../groupbox/index.html">Groupbox</a></li> <li><a href="../image/index.html">Image</a></li> <li><a href="../keyboard/index.html">Keyboard</a></li> <li><a href="../label/index.html">Label</a></li> <li><a href="../numberbox/index.html">Numberbox</a></li> <li><a href="../sliders/index.html">Sliders</a></li> <li><a href="../soundfiler/index.html">Soundfiler</a></li> <li><a href="../table/index.html">Table</a></li> <li><a href="../textbox/index.html">Textbox</a></li> <li><a href="../texteditor/index.html">Texteditor</a></li> <li><a href="../vrange/index.html">Vrange</a></li> <li><a href="../xypad/index.html">Xypad</a></li> </ul> </li> </ul> <ul> <li> <a href=http://cabbageaudio.com class=sub-menu-trigger> <i class=icon-right-open></i>&nbsp; Extras </a> <ul class=submenu> <li><a href="../identchannels/index.html">Identchannels</a></li> <li><a href="../plants/index.html">Plants</a></li> <li><a href="../presets/index.html">Presets</a></li> <li><a href="../gui_designer/index.html">Gui Designer</a></li> <li><a href="../widget_arrays/index.html">Widget Arrays</a></li> <li><a href="../managing_large_numbers_of_widgets/index.html">Managing Large Numbers Of Widgets</a></li> <li><a href="../macros_and_reserved_channels/index.html">Macros And Reserved Channels</a></li> <li><a href="../using_svgs/index.html">Using Svgs</a></li> </ul> </li> </ul> <ul> <li> <a href=http://cabbageaudio.com class=sub-menu-trigger> <i class=icon-right-open></i>&nbsp; Csound </a> <ul class=submenu> <li><a href="../csound_syntax/index.html">Csound Syntax</a></li> <li><a href="../keywords/index.html">Keywords</a></li> <li><a href="../contants_and_variables/index.html">Contants And Variables</a></li> <li><a href="../opcodes/index.html">Opcodes</a></li> <li><a href="../operators_and_comments/index.html">Operators And Comments</a></li> <li><a href="../beginner_synth/index.html">Beginner Synth</a></li> </ul> </li> </ul> <ul class=active-sub-item> <li> <a href=http://cabbageaudio.com class=sub-menu-trigger> <i class="icon-right-open active-sub-item"></i>&nbsp; Extending Cabbage </a> <ul class=submenu> <li><a href="../new_widgets_part_1/index.html">New Widgets Part 1</a></li> <li><a href="../new_widgets_part_2/index.html">New Widgets Part 2</a></li> <li class=current><a href="index.html">New Widgets Part 3</a></li> </ul> </li> </ul> </nav> </aside> <div class=doc-content> <i class="toggle-nav icon icon-menu">&#xe81b;</i> <div class=container> <article class=post>  <div class=post-content> <h1>New Widgets, Part 3</h1> <p>We now have a simple step sequencer that the user can click on to enable steps. They can also see which is the current step in the sequence. But it remains quite useless until we can get it to communicate with the underlying instance of Csound. Cabbage widgets communicate with Csound through the use of named channels. For example, whenever a sure moves a slider in Cabbage, the value of that slider gets sent to Csound over a named channel bus. Each widget that is capable of affecting change in a Csound instrument must have a channel associated with it. So our widget must also have an associated channel. We can retrieve the name of the channel by accessing the string passed to the channel identifier. </p> <div class=highlight><pre><code class=language-csharp data-lang=csharp><span class=k>class</span> <span class=nc>CabbageStepper</span>    <span class=p>:</span>   <span class=k>public</span> <span class=n>Component</span><span class=p>,</span> <span class=k>public</span> <span class=n>Timer</span>
<span class=p>{</span>
    <span class=n>String</span> <span class=n>name</span><span class=p>,</span> <span class=n>channel</span><span class=p>;</span>
    <span class=kt>float</span> <span class=n>numberOfSteps</span><span class=p>;</span>
    <span class=kt>int</span> <span class=n>stepBPM</span><span class=p>,</span> <span class=n>currentStep</span><span class=p>;</span>
    <span class=n>Colour</span> <span class=n>colour</span><span class=p>;</span>
    <span class=n>Array</span><span class=p>&lt;</span><span class=kt>int</span><span class=p>&gt;</span> <span class=n>stepStates</span><span class=p>;</span>

    <span class=k>public</span><span class=p>:</span>

    <span class=nf>CabbageStepper</span> <span class=p>(</span><span class=n>CabbageGUIType</span> <span class=p>&amp;</span><span class=n>cAttr</span><span class=p>,</span> <span class=n>CabbagePluginAudioProcessorEditor</span><span class=p>*</span> <span class=n>_owner</span><span class=p>)</span>
        <span class=p>:</span> <span class=nf>Component</span><span class=p>(),</span> 
        <span class=nf>owner</span><span class=p>(</span><span class=n>_owner</span><span class=p>),</span>
        <span class=nf>name</span><span class=p>(</span><span class=n>cAttr</span><span class=p>.</span><span class=nf>getStringProp</span><span class=p>(</span><span class=n>CabbageIDs</span><span class=p>::</span><span class=n>name</span><span class=p>)),</span>
        <span class=nf>channel</span><span class=p>(</span><span class=n>cAttr</span><span class=p>.</span><span class=nf>getStringProp</span><span class=p>(</span><span class=n>CabbageIDs</span><span class=p>::</span><span class=n>channel</span><span class=p>)),</span>
        <span class=nf>colour</span><span class=p>(</span><span class=n>Colour</span><span class=p>::</span><span class=nf>fromString</span><span class=p>(</span><span class=n>cAttr</span><span class=p>.</span><span class=nf>getStringProp</span><span class=p>(</span><span class=n>CabbageIDs</span><span class=p>::</span><span class=n>colour</span><span class=p>))),</span>
        <span class=nf>stepBPM</span><span class=p>(</span><span class=n>cAttr</span><span class=p>.</span><span class=nf>getNumProp</span><span class=p>(</span><span class=s>"stepbpm"</span><span class=p>)),</span>
        <span class=nf>numberOfSteps</span><span class=p>(</span><span class=n>cAttr</span><span class=p>.</span><span class=nf>getNumProp</span><span class=p>(</span><span class=s>"numberofsteps"</span><span class=p>)),</span>
        <span class=nf>currentStep</span><span class=p>(</span><span class=m>0</span><span class=p>)</span>
    <span class=p>{</span>
<span class=p>(...)</span>
</code></pre></div> <h3>Sending messages to Csound channels</h3> <p>An instance of Csound is created in the CabbagePluginAudioProcessor class, but we don&#39;t need to access it directly. We need only add some messages to the outgoing messages which are stored in CabbagePluginAudioProcesso::messageQueue. To access our main AudioProcessror class we can call the CabbagePluginAudioProcessorEditor::getFilter() method. We can then add some messages to the outgoing queue. At every k-boundary Cabbage will send the messages to Csound, this ensures complete thread safety. The best place to add messages to our queue is in the <code>timerCallback()</code> function. </p> <div class=highlight><pre><code class=language-csharp data-lang=csharp><span class=k>void</span> <span class=n>CabbageStepper</span><span class=p>::</span><span class=nf>timerCallback</span><span class=p>()</span>
<span class=p>{</span>
    <span class=n>currentStep</span> <span class=p>=</span> <span class=n>currentStep</span><span class=p>&lt;</span><span class=m>11</span> <span class=p>?</span> <span class=n>currentStep</span><span class=p>+</span><span class=m>1</span> <span class=p>:</span> <span class=m>0</span><span class=p>;</span>
    <span class=kt>int</span> <span class=n>valueToSendToCsound</span> <span class=p>=</span> <span class=n>stepStates</span><span class=p>[</span><span class=n>currentStep</span><span class=p>]==</span><span class=m>1</span> <span class=p>?</span> <span class=n>currentStep</span><span class=p>+</span><span class=m>1</span> <span class=p>:</span> <span class=m>0</span><span class=p>;</span>
    <span class=n>owner</span><span class=p>-&gt;</span><span class=nf>getFilter</span><span class=p>()-&gt;</span><span class=n>messageQueue</span><span class=p>.</span><span class=nf>addOutgoingChannelMessageToQueue</span><span class=p>(</span><span class=n>channel</span><span class=p>,</span> <span class=n>valueToSendToCsound</span><span class=p>,</span> <span class=n>String</span><span class=p>::</span><span class=n>empty</span><span class=p>);</span>
    <span class=nf>repaint</span><span class=p>();</span>
<span class=p>}</span> 
</code></pre></div> <p><code>addOutgoingChannelMessageToQueue(...)</code> takes three parameters. The first parameter is the name of the channel to communicate with Csound on. The next parameter is the value to send, and the final parameter is the message type, which is only used for special message types. In most cases this can be set to an empty string. </p> <p>With this final method in place, Cabbage will send messages to Csound on each step. It will send a 0 if the step is disabled, otherwise it will send the step index+1. In order to use this widget with a Csound instrument we can do something like this. </p> <div class=highlight><pre><code class=language-csharp data-lang=csharp><span class=p>&lt;</span><span class=n>Cabbage</span><span class=p>&gt;</span>
<span class=n>form</span> <span class=nf>size</span><span class=p>(</span><span class=m>500</span><span class=p>,</span> <span class=m>100</span><span class=p>),</span> <span class=nf>caption</span><span class=p>(</span><span class=s>"Stepper"</span><span class=p>),</span> <span class=nf>pluginID</span><span class=p>(</span><span class=s>"plu1"</span><span class=p>),</span> <span class=nf>colour</span><span class=p>(</span><span class=m>57</span><span class=p>,</span> <span class=m>110</span><span class=p>,</span> <span class=m>185</span><span class=p>)</span>
<span class=n>stepper</span> <span class=nf>bounds</span><span class=p>(</span><span class=m>10</span><span class=p>,</span> <span class=m>10</span><span class=p>,</span> <span class=m>480</span><span class=p>,</span> <span class=m>40</span><span class=p>),</span> <span class=nf>channel</span><span class=p>(</span><span class=s>"step1"</span><span class=p>),</span> <span class=nf>colour</span><span class=p>(</span><span class=s>"white"</span><span class=p>),</span> <span class=nf>numberofsteps</span><span class=p>(</span><span class=m>12</span><span class=p>),</span> <span class=nf>stepbpm</span><span class=p>(</span><span class=m>120</span><span class=p>)</span>
<span class=p>&lt;/</span><span class=n>Cabbage</span><span class=p>&gt;</span>
<span class=p>&lt;</span><span class=n>CsoundSynthesizer</span><span class=p>&gt;</span>
<span class=p>&lt;</span><span class=n>CsOptions</span><span class=p>&gt;</span> 
<span class=p>-</span><span class=n>m0d</span>
<span class=p>&lt;/</span><span class=n>CsOptions</span><span class=p>&gt;</span>
<span class=p>&lt;</span><span class=n>CsInstruments</span><span class=p>&gt;</span>
<span class=n>sr</span> <span class=p>=</span> <span class=m>44100</span>
<span class=n>ksmps</span> <span class=p>=</span> <span class=m>16</span>
<span class=n>nchnls</span> <span class=p>=</span> <span class=m>2</span>
<span class=m>0d</span><span class=n>bfs</span><span class=p>=</span><span class=m>1</span>

<span class=n>instr</span> <span class=m>1</span>
<span class=k>if</span> <span class=n>changed</span><span class=p>:</span><span class=nf>k</span><span class=p>(</span><span class=n>chnget</span><span class=p>:</span><span class=nf>k</span><span class=p>(</span><span class=s>"step1"</span><span class=p>))==</span><span class=m>1</span> <span class=p>&amp;&amp;</span> <span class=n>chnget</span><span class=p>:</span><span class=nf>k</span><span class=p>(</span><span class=s>"step1"</span><span class=p>)!=</span><span class=m>0</span> <span class=n>then</span>
    <span class=k>event</span> <span class=s>"i"</span><span class=p>,</span> <span class=m>2</span><span class=p>,</span> <span class=m>0</span><span class=p>,</span> <span class=m>3</span>
<span class=n>endif</span>
<span class=n>endin</span>

<span class=n>instr</span> <span class=m>2</span>
    <span class=n>print</span> <span class=n>p1</span>
    <span class=n>a1</span> <span class=n>expon</span> <span class=m>1</span><span class=p>,</span> <span class=n>p3</span><span class=p>,</span> <span class=m>0.001</span>
    <span class=n>a2</span> <span class=n>oscili</span> <span class=n>a1</span><span class=p>,</span> <span class=m>256</span>
    <span class=n>outs</span> <span class=n>a2</span><span class=p>,</span> <span class=n>a2</span>
<span class=n>endin</span>

<span class=p>&lt;/</span><span class=n>CsInstruments</span><span class=p>&gt;</span>  
<span class=p>&lt;</span><span class=n>CsScore</span><span class=p>&gt;</span>
<span class=n>i1</span> <span class=m>0</span> <span class=m>5000</span>
<span class=p>&lt;/</span><span class=n>CsScore</span><span class=p>&gt;</span>
<span class=p>&lt;/</span><span class=n>CsoundSynthesizer</span><span class=p>&gt;</span>
</code></pre></div> <p>Whenever channel &quot;step1&quot; changes, and is not equal to 0, we trigger instr 2 to play a note. </p> <h3>Using Csound to control our widget</h3> <p>Our new stepper widget serves as a good example of how easy it is to add new widget types to Cabbage, but it&#39;s still not quite ready for public consumption. There are still quite a few additions we could make to enhance the widget and provide users with a greater level of control. Perhaps the most important thing is to provide users with a way of turning the sequencer on or off. We could simply add a check box to our widget that will turn it on or off, but this will inevitably leads to problems if you wish to stack several steppers on top of each other. It would be very frustrating for the end-user if they have to enable each stepper widget manually. A better approach would be to provide them with a way of turning the sequence on or off from Csound. We can do this using identifier channels. </p> <p>The <code>CabbagePluginAudioProcessor::updateGUIControls()</code> method checks for incoming identifier strings from Csound and gets called at every k-cycle. Identifier strings can be sent to a Cabbage widget using the chnset opcode in Csound. Once a string is sent, Cabbage parses it and updates the widget accordingly. Each widget that accepts identifier strings needs to implement an update(...) function. If you browse through the <code>CabbagePluginAudioProcessor::updateGUIControls()</code> code you&#39;ll seeing the following conditional statement. </p> <div class=highlight><pre><code class=language-csharp data-lang=csharp>    <span class=c1>//sample stepper widget
</span>    <span class=k>else</span> <span class=k>if</span><span class=p>(</span><span class=nf>checkForIdentifierMessage</span><span class=p>(</span><span class=nf>getFilter</span><span class=p>()-&gt;</span><span class=nf>getGUILayoutCtrls</span><span class=p>(</span><span class=n>i</span><span class=p>),</span> <span class=s>"stepper"</span><span class=p>))</span>
    <span class=p>{</span>
        <span class=p>((</span><span class=n>CabbageStepper</span><span class=p>*)</span><span class=n>layoutComps</span><span class=p>[</span><span class=n>i</span><span class=p>])-&gt;</span><span class=nf>update</span><span class=p>(</span><span class=nf>getFilter</span><span class=p>()-&gt;</span><span class=nf>getGUILayoutCtrls</span><span class=p>(</span><span class=n>i</span><span class=p>));</span>
        <span class=nf>getFilter</span><span class=p>()-&gt;</span><span class=nf>getGUILayoutCtrls</span><span class=p>(</span><span class=n>i</span><span class=p>).</span><span class=nf>setStringProp</span><span class=p>(</span><span class=n>CabbageIDs</span><span class=p>::</span><span class=n>identchannelmessage</span><span class=p>,</span> <span class=s>""</span><span class=p>);</span>
    <span class=p>}</span>
</code></pre></div> <p>The <code>checkForIdentifierMessage(...)</code> method checks for the existence of an identifier string for a particular widget type. If an incoming string identifier is found it calls the widget classes <code>update(...)</code> function.</p> <h3>Writing an update function</h3> <p>The update function gets passed a CabbageGUIType class object which provides us with all the information we need in order to update out widget. If for example we want to allow users to update the widget&#39;s colour from Csound we might do something like this in our <code>update(...)</code> method.</p> <div class=highlight><pre><code class=language-csharp data-lang=csharp><span class=k>void</span> <span class=n>CabbageStepper</span><span class=p>::</span><span class=nf>update</span><span class=p>(</span><span class=n>CabbageGUIType</span> <span class=n>cAttr</span><span class=p>)</span>
<span class=p>{</span>
    <span class=k>if</span><span class=p>(</span><span class=n>colour</span><span class=p>.</span><span class=nf>toString</span><span class=p>()!=</span><span class=n>cAttr</span><span class=p>.</span><span class=nf>getStringProp</span><span class=p>(</span><span class=s>"colour"</span><span class=p>))</span>
    <span class=p>{</span>
        <span class=n>colour</span> <span class=p>=</span> <span class=n>Colour</span><span class=p>::</span><span class=nf>fromString</span><span class=p>(</span><span class=n>cAttr</span><span class=p>.</span><span class=nf>getStringProp</span><span class=p>(</span><span class=s>"colour"</span><span class=p>));</span>
    <span class=p>}</span>
<span class=p>}</span>
</code></pre></div> <p>We can now change the colour of our widget using the following Cabbage/Csound code: ```csharp <cabbage> form size(500, 150), caption(&quot;Stepper&quot;), pluginID(&quot;plu1&quot;), colour(57, 110, 185) stepper bounds(10, 10, 480, 40), channel(&quot;step1&quot;), colour(&quot;white&quot;), numberofsteps(12), stepbpm(120), identchannel(&quot;stepIdent&quot;) button bounds(12, 58, 120, 25), channel(&quot;colourButton&quot;), text(&quot;Change colour&quot;) </cabbage> <csoundsynthesizer> <csoptions> -m0d </csoptions> <csinstruments> sr = 44100 ksmps = 16 nchnls = 2 0dbfs=1</csinstruments></csoundsynthesizer></p> <p>instr 1 if changed:k(chnget:k(&quot;colourButton&quot;))==1 then if chnget:k(&quot;colourButton&quot;)==1 then chnset &quot;colour(255, 255, 0)&quot;, &quot;stepIdent&quot; else chnset &quot;colour(255, 255, 255)&quot;, &quot;stepIdent&quot; endif endif</p> <p>(...) ```</p> <p><img src="../../images/docs/newWidgetColourUpdate.gif"></p> <p>It won&#39;t take much to update our <code>update()</code> function so that users can turn the step sequencer on and off, as well as control the tempo. We will need to add a new member variable to hold the running state of the widget. We can call it <code>isRunning</code>, and we will let users use the pre-existing <code>active()</code> identifier to set the running state. Our updated constructor will look like this.</p> <div class=highlight><pre><code class=language-csharp data-lang=csharp><span class=n>CabbageStepper</span><span class=p>::</span><span class=nf>CabbageStepper</span> <span class=p>(</span><span class=n>CabbageGUIType</span> <span class=p>&amp;</span><span class=n>cAttr</span><span class=p>,</span> <span class=n>CabbagePluginAudioProcessorEditor</span><span class=p>*</span> <span class=n>_owner</span><span class=p>)</span>
        <span class=p>:</span> <span class=nf>Component</span><span class=p>(),</span> 
        <span class=nf>owner</span><span class=p>(</span><span class=n>_owner</span><span class=p>),</span>
        <span class=nf>name</span><span class=p>(</span><span class=n>cAttr</span><span class=p>.</span><span class=nf>getStringProp</span><span class=p>(</span><span class=n>CabbageIDs</span><span class=p>::</span><span class=n>name</span><span class=p>)),</span>
        <span class=nf>channel</span><span class=p>(</span><span class=n>cAttr</span><span class=p>.</span><span class=nf>getStringProp</span><span class=p>(</span><span class=n>CabbageIDs</span><span class=p>::</span><span class=n>channel</span><span class=p>)),</span>
        <span class=nf>colour</span><span class=p>(</span><span class=n>Colour</span><span class=p>::</span><span class=nf>fromString</span><span class=p>(</span><span class=n>cAttr</span><span class=p>.</span><span class=nf>getStringProp</span><span class=p>(</span><span class=n>CabbageIDs</span><span class=p>::</span><span class=n>colour</span><span class=p>))),</span>
        <span class=nf>stepBPM</span><span class=p>(</span><span class=n>cAttr</span><span class=p>.</span><span class=nf>getNumProp</span><span class=p>(</span><span class=s>"stepbpm"</span><span class=p>)),</span>
        <span class=nf>numberOfSteps</span><span class=p>(</span><span class=n>cAttr</span><span class=p>.</span><span class=nf>getNumProp</span><span class=p>(</span><span class=s>"numberofsteps"</span><span class=p>)),</span>
        <span class=nf>currentStep</span><span class=p>(</span><span class=m>0</span><span class=p>),</span>
        <span class=nf>isRunning</span><span class=p>(</span><span class=n>cAttr</span><span class=p>.</span><span class=nf>getNumProp</span><span class=p>(</span><span class=n>CabbageIDs</span><span class=p>::</span><span class=n>active</span><span class=p>)==</span><span class=m>1</span> <span class=p>?</span> <span class=k>true</span> <span class=p>:</span> <span class=k>false</span><span class=p>)</span>
<span class=p>{</span>
    <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=p>=</span> <span class=m>0</span><span class=p>;</span> <span class=n>i</span> <span class=p>&lt;</span> <span class=n>numberOfSteps</span><span class=p>;</span><span class=n>i</span><span class=p>++</span> <span class=p>)</span>
        <span class=n>stepStates</span><span class=p>.</span><span class=k>add</span><span class=p>(</span><span class=m>0</span><span class=p>);</span>

    <span class=nf>startTimer</span><span class=p>((</span><span class=m>60.f</span><span class=p>/</span><span class=n>stepBPM</span><span class=p>)*</span><span class=m>1000.f</span><span class=p>);</span>
<span class=p>}</span>
</code></pre></div> <p>And our new <code>update()</code> function will now look like this.</p> <div class=highlight><pre><code class=language-csharp data-lang=csharp><span class=k>void</span> <span class=n>CabbageStepper</span><span class=p>::</span><span class=nf>update</span><span class=p>(</span><span class=n>CabbageGUIType</span> <span class=n>cAttr</span><span class=p>)</span>
<span class=p>{</span>
    <span class=k>if</span><span class=p>(</span><span class=n>cAttr</span><span class=p>.</span><span class=nf>getNumProp</span><span class=p>(</span><span class=s>"stepbpm"</span><span class=p>)!=</span><span class=n>stepBPM</span><span class=p>)</span>
    <span class=p>{</span>
        <span class=n>stepBPM</span> <span class=p>=</span> <span class=n>cAttr</span><span class=p>.</span><span class=nf>getNumProp</span><span class=p>(</span><span class=s>"stepbpm"</span><span class=p>);</span>
    <span class=p>}</span>

    <span class=k>if</span><span class=p>(</span><span class=n>cAttr</span><span class=p>.</span><span class=nf>getNumProp</span><span class=p>(</span><span class=n>CabbageIDs</span><span class=p>::</span><span class=n>active</span><span class=p>)!=</span><span class=n>isRunning</span><span class=p>)</span>
    <span class=p>{</span>
        <span class=n>isRunning</span> <span class=p>=</span> <span class=n>cAttr</span><span class=p>.</span><span class=nf>getNumProp</span><span class=p>(</span><span class=n>CabbageIDs</span><span class=p>::</span><span class=n>active</span><span class=p>);</span>
        <span class=k>if</span><span class=p>(</span><span class=n>isRunning</span><span class=p>==</span><span class=m>1</span><span class=p>)</span>
            <span class=nf>startTimer</span><span class=p>((</span><span class=m>60.f</span><span class=p>/</span><span class=n>stepBPM</span><span class=p>)*</span><span class=m>1000.f</span><span class=p>);</span>
        <span class=k>else</span>
            <span class=nf>stopTimer</span><span class=p>();</span>
    <span class=p>}</span>

    <span class=k>if</span><span class=p>(</span><span class=n>colour</span><span class=p>.</span><span class=nf>toString</span><span class=p>()!=</span><span class=n>cAttr</span><span class=p>.</span><span class=nf>getStringProp</span><span class=p>(</span><span class=s>"colour"</span><span class=p>))</span>
        <span class=n>colour</span> <span class=p>=</span> <span class=n>Colour</span><span class=p>::</span><span class=nf>fromString</span><span class=p>(</span><span class=n>cAttr</span><span class=p>.</span><span class=nf>getStringProp</span><span class=p>(</span><span class=s>"colour"</span><span class=p>));</span>
<span class=p>}</span>
</code></pre></div> <h3>Putting it all together</h3> <p>Now that we have a way to turn on and off our widget we can create a more musically interesting instrument. We can for example stack several stepper widgets on top of each to create a simple grid sequencer. Below is a simple instrument demonstrating this. It uses a simple User Defined Opcode to enable and disable the steppers, but everything else is kept as simple as possible. </p> <div class=highlight><pre><code class=language-csharp data-lang=csharp><span class=p>&lt;</span><span class=n>Cabbage</span><span class=p>&gt;</span>
<span class=n>form</span> <span class=nf>size</span><span class=p>(</span><span class=m>500</span><span class=p>,</span> <span class=m>430</span><span class=p>),</span> <span class=nf>caption</span><span class=p>(</span><span class=s>"Stepper"</span><span class=p>),</span> <span class=nf>pluginID</span><span class=p>(</span><span class=s>"plu1"</span><span class=p>),</span> <span class=nf>colour</span><span class=p>(</span><span class=m>57</span><span class=p>,</span> <span class=m>110</span><span class=p>,</span> <span class=m>185</span><span class=p>)</span>
<span class=n>button</span> <span class=nf>bounds</span><span class=p>(</span><span class=m>178</span><span class=p>,</span> <span class=m>345</span><span class=p>,</span> <span class=m>135</span><span class=p>,</span> <span class=m>31</span><span class=p>),</span> <span class=nf>channel</span><span class=p>(</span><span class=s>"startButton"</span><span class=p>),</span> <span class=n>colour</span><span class=p>:</span><span class=m>1</span><span class=p>(</span><span class=s>"lime"</span><span class=p>),</span> <span class=nf>text</span><span class=p>(</span><span class=s>"Start"</span><span class=p>,</span> <span class=s>"Stop"</span><span class=p>)</span>
<span class=n>stepper</span> <span class=nf>bounds</span><span class=p>(</span><span class=m>10</span><span class=p>,</span> <span class=m>10</span><span class=p>,</span> <span class=m>480</span><span class=p>,</span> <span class=m>40</span><span class=p>),</span> <span class=nf>channel</span><span class=p>(</span><span class=s>"c4"</span><span class=p>),</span> <span class=nf>colour</span><span class=p>(</span><span class=s>"white"</span><span class=p>),</span> <span class=nf>numberofsteps</span><span class=p>(</span><span class=m>12</span><span class=p>),</span> <span class=nf>stepbpm</span><span class=p>(</span><span class=m>120</span><span class=p>),</span>  <span class=nf>active</span><span class=p>(</span><span class=m>0</span><span class=p>),</span> <span class=nf>identchannel</span><span class=p>(</span><span class=s>"stepIdent1"</span><span class=p>)</span> 
<span class=n>stepper</span> <span class=nf>bounds</span><span class=p>(</span><span class=m>10</span><span class=p>,</span> <span class=m>50</span><span class=p>,</span> <span class=m>480</span><span class=p>,</span> <span class=m>40</span><span class=p>),</span> <span class=nf>channel</span><span class=p>(</span><span class=s>"b3"</span><span class=p>),</span> <span class=nf>colour</span><span class=p>(</span><span class=s>"white"</span><span class=p>),</span> <span class=nf>numberofsteps</span><span class=p>(</span><span class=m>12</span><span class=p>),</span> <span class=nf>stepbpm</span><span class=p>(</span><span class=m>120</span><span class=p>),</span>  <span class=nf>active</span><span class=p>(</span><span class=m>0</span><span class=p>),</span> <span class=nf>identchannel</span><span class=p>(</span><span class=s>"stepIdent2"</span><span class=p>)</span>
<span class=n>stepper</span> <span class=nf>bounds</span><span class=p>(</span><span class=m>10</span><span class=p>,</span> <span class=m>90</span><span class=p>,</span> <span class=m>480</span><span class=p>,</span> <span class=m>40</span><span class=p>),</span> <span class=nf>channel</span><span class=p>(</span><span class=s>"a3"</span><span class=p>),</span> <span class=nf>colour</span><span class=p>(</span><span class=s>"white"</span><span class=p>),</span> <span class=nf>numberofsteps</span><span class=p>(</span><span class=m>12</span><span class=p>),</span> <span class=nf>stepbpm</span><span class=p>(</span><span class=m>120</span><span class=p>),</span>  <span class=nf>active</span><span class=p>(</span><span class=m>0</span><span class=p>),</span> <span class=nf>identchannel</span><span class=p>(</span><span class=s>"stepIdent3"</span><span class=p>)</span>
<span class=n>stepper</span> <span class=nf>bounds</span><span class=p>(</span><span class=m>10</span><span class=p>,</span> <span class=m>130</span><span class=p>,</span> <span class=m>480</span><span class=p>,</span> <span class=m>40</span><span class=p>),</span> <span class=nf>channel</span><span class=p>(</span><span class=s>"g3"</span><span class=p>),</span> <span class=nf>colour</span><span class=p>(</span><span class=s>"white"</span><span class=p>),</span> <span class=nf>numberofsteps</span><span class=p>(</span><span class=m>12</span><span class=p>),</span> <span class=nf>stepbpm</span><span class=p>(</span><span class=m>120</span><span class=p>),</span> <span class=nf>active</span><span class=p>(</span><span class=m>0</span><span class=p>),</span> <span class=nf>identchannel</span><span class=p>(</span><span class=s>"stepIdent4"</span><span class=p>)</span>
<span class=n>stepper</span> <span class=nf>bounds</span><span class=p>(</span><span class=m>10</span><span class=p>,</span> <span class=m>170</span><span class=p>,</span> <span class=m>480</span><span class=p>,</span> <span class=m>40</span><span class=p>),</span> <span class=nf>channel</span><span class=p>(</span><span class=s>"f3"</span><span class=p>),</span> <span class=nf>colour</span><span class=p>(</span><span class=s>"white"</span><span class=p>),</span> <span class=nf>numberofsteps</span><span class=p>(</span><span class=m>12</span><span class=p>),</span> <span class=nf>stepbpm</span><span class=p>(</span><span class=m>120</span><span class=p>),</span> <span class=nf>active</span><span class=p>(</span><span class=m>0</span><span class=p>),</span> <span class=nf>identchannel</span><span class=p>(</span><span class=s>"stepIdent5"</span><span class=p>)</span>
<span class=n>stepper</span> <span class=nf>bounds</span><span class=p>(</span><span class=m>10</span><span class=p>,</span> <span class=m>210</span><span class=p>,</span> <span class=m>480</span><span class=p>,</span> <span class=m>40</span><span class=p>),</span> <span class=nf>channel</span><span class=p>(</span><span class=s>"e3"</span><span class=p>),</span> <span class=nf>colour</span><span class=p>(</span><span class=s>"white"</span><span class=p>),</span> <span class=nf>numberofsteps</span><span class=p>(</span><span class=m>12</span><span class=p>),</span> <span class=nf>stepbpm</span><span class=p>(</span><span class=m>120</span><span class=p>),</span> <span class=nf>active</span><span class=p>(</span><span class=m>0</span><span class=p>),</span> <span class=nf>identchannel</span><span class=p>(</span><span class=s>"stepIdent6"</span><span class=p>)</span>
<span class=n>stepper</span> <span class=nf>bounds</span><span class=p>(</span><span class=m>10</span><span class=p>,</span> <span class=m>250</span><span class=p>,</span> <span class=m>480</span><span class=p>,</span> <span class=m>40</span><span class=p>),</span> <span class=nf>channel</span><span class=p>(</span><span class=s>"d3"</span><span class=p>),</span> <span class=nf>colour</span><span class=p>(</span><span class=s>"white"</span><span class=p>),</span> <span class=nf>numberofsteps</span><span class=p>(</span><span class=m>12</span><span class=p>),</span> <span class=nf>stepbpm</span><span class=p>(</span><span class=m>120</span><span class=p>),</span> <span class=nf>active</span><span class=p>(</span><span class=m>0</span><span class=p>),</span> <span class=nf>identchannel</span><span class=p>(</span><span class=s>"stepIdent7"</span><span class=p>)</span>
<span class=n>stepper</span> <span class=nf>bounds</span><span class=p>(</span><span class=m>10</span><span class=p>,</span> <span class=m>290</span><span class=p>,</span> <span class=m>480</span><span class=p>,</span> <span class=m>40</span><span class=p>),</span> <span class=nf>channel</span><span class=p>(</span><span class=s>"c3"</span><span class=p>),</span> <span class=nf>colour</span><span class=p>(</span><span class=s>"white"</span><span class=p>),</span> <span class=nf>numberofsteps</span><span class=p>(</span><span class=m>12</span><span class=p>),</span> <span class=nf>stepbpm</span><span class=p>(</span><span class=m>120</span><span class=p>),</span> <span class=nf>active</span><span class=p>(</span><span class=m>0</span><span class=p>),</span> <span class=nf>identchannel</span><span class=p>(</span><span class=s>"stepIdent8"</span><span class=p>)</span>

<span class=n>rslider</span> <span class=nf>bounds</span><span class=p>(</span><span class=m>12</span><span class=p>,</span> <span class=m>340</span><span class=p>,</span> <span class=m>80</span><span class=p>,</span> <span class=m>80</span><span class=p>),</span> <span class=nf>channel</span><span class=p>(</span><span class=s>"bpm"</span><span class=p>),</span> <span class=nf>range</span><span class=p>(</span><span class=m>40</span><span class=p>,</span> <span class=m>180</span><span class=p>,</span> <span class=m>60</span><span class=p>),</span> <span class=nf>text</span><span class=p>(</span><span class=s>"BPM"</span><span class=p>),</span> <span class=nf>trackercolour</span><span class=p>(</span><span class=s>"lime"</span><span class=p>)</span>
<span class=n>rslider</span> <span class=nf>bounds</span><span class=p>(</span><span class=m>92</span><span class=p>,</span> <span class=m>340</span><span class=p>,</span> <span class=m>80</span><span class=p>,</span> <span class=m>80</span><span class=p>),</span> <span class=nf>channel</span><span class=p>(</span><span class=s>"gain"</span><span class=p>),</span> <span class=nf>range</span><span class=p>(</span><span class=m>0</span><span class=p>,</span> <span class=p>.</span><span class=m>7</span><span class=p>,</span> <span class=p>.</span><span class=m>5</span><span class=p>),</span> <span class=nf>text</span><span class=p>(</span><span class=s>"Gain"</span><span class=p>),</span> <span class=nf>trackercolour</span><span class=p>(</span><span class=s>"lime"</span><span class=p>)</span>

<span class=p>&lt;/</span><span class=n>Cabbage</span><span class=p>&gt;</span>
<span class=p>&lt;</span><span class=n>CsoundSynthesizer</span><span class=p>&gt;</span>
<span class=p>&lt;</span><span class=n>CsOptions</span><span class=p>&gt;</span> 
<span class=p>-</span><span class=n>m0d</span>
<span class=p>&lt;/</span><span class=n>CsOptions</span><span class=p>&gt;</span>
<span class=p>&lt;</span><span class=n>CsInstruments</span><span class=p>&gt;</span>
<span class=n>sr</span> <span class=p>=</span> <span class=m>44100</span>
<span class=n>ksmps</span> <span class=p>=</span> <span class=m>16</span>
<span class=n>nchnls</span> <span class=p>=</span> <span class=m>2</span>
<span class=m>0d</span><span class=n>bfs</span><span class=p>=</span><span class=m>1</span>

<span class=n>opcode</span> <span class=n>controlSteppers</span><span class=p>,</span> <span class=n>k</span><span class=p>,</span> <span class=n>kk</span>
    <span class=n>kStart</span><span class=p>,</span> <span class=n>kBPM</span> <span class=n>xin</span>
    <span class=n>SMessage</span> <span class=n>sprintfk</span> <span class=s>"stepbpm(%d), active(%d)"</span><span class=p>,</span> <span class=n>kBPM</span><span class=p>,</span> <span class=n>kStart</span>
    <span class=n>chnset</span> <span class=n>SMessage</span><span class=p>,</span> <span class=s>"stepIdent1"</span>
    <span class=n>chnset</span> <span class=n>SMessage</span><span class=p>,</span> <span class=s>"stepIdent2"</span>
    <span class=n>chnset</span> <span class=n>SMessage</span><span class=p>,</span> <span class=s>"stepIdent3"</span>
    <span class=n>chnset</span> <span class=n>SMessage</span><span class=p>,</span> <span class=s>"stepIdent4"</span>
    <span class=n>chnset</span> <span class=n>SMessage</span><span class=p>,</span> <span class=s>"stepIdent5"</span>
    <span class=n>chnset</span> <span class=n>SMessage</span><span class=p>,</span> <span class=s>"stepIdent6"</span>
    <span class=n>chnset</span> <span class=n>SMessage</span><span class=p>,</span> <span class=s>"stepIdent7"</span>
    <span class=n>chnset</span> <span class=n>SMessage</span><span class=p>,</span> <span class=s>"stepIdent8"</span>
<span class=n>xout</span> <span class=n>kStart</span>
<span class=n>endop</span>


<span class=p>;</span><span class=n>main</span> <span class=n>instrument</span>
<span class=n>instr</span> <span class=m>1</span>
    <span class=p>;</span><span class=n>check</span> <span class=k>if</span> <span class=n>user</span> <span class=n>has</span> <span class=n>pressed</span> <span class=n>the</span> <span class=n>start</span> <span class=n>button</span>
    <span class=n>kStartStop</span> <span class=n>chnget</span> <span class=s>"startButton"</span>
    <span class=n>kTempo</span> <span class=n>chnget</span> <span class=s>"bpm"</span>
    <span class=k>if</span> <span class=n>changed</span><span class=p>:</span><span class=nf>k</span><span class=p>(</span><span class=n>kStartStop</span><span class=p>)==</span><span class=m>1</span> <span class=p>||</span> <span class=n>changed</span><span class=p>:</span><span class=nf>k</span><span class=p>(</span><span class=n>kTempo</span><span class=p>)==</span><span class=m>1</span> <span class=n>then</span>
        <span class=k>if</span> <span class=n>chnget</span><span class=p>:</span><span class=nf>k</span><span class=p>(</span><span class=s>"startButton"</span><span class=p>)==</span><span class=m>1</span> <span class=n>then</span>
            <span class=n>k1</span> <span class=n>controlSteppers</span> <span class=m>1</span><span class=p>,</span> <span class=n>kTempo</span>
        <span class=k>else</span>
            <span class=n>k1</span> <span class=n>controlSteppers</span> <span class=m>0</span><span class=p>,</span> <span class=n>kTempo</span>
        <span class=n>endif</span>
    <span class=n>endif</span>

    <span class=p>;</span><span class=n>trigger</span> <span class=n>notes</span> <span class=n>according</span> <span class=n>to</span> <span class=n>which</span> <span class=n>steps</span> <span class=n>are</span> <span class=n>activated</span>
    <span class=k>if</span> <span class=n>changed</span><span class=p>:</span><span class=nf>k</span><span class=p>(</span><span class=n>chnget</span><span class=p>:</span><span class=nf>k</span><span class=p>(</span><span class=s>"c4"</span><span class=p>))==</span><span class=m>1</span> <span class=p>&amp;&amp;</span> <span class=n>chnget</span><span class=p>:</span><span class=nf>k</span><span class=p>(</span><span class=s>"c4"</span><span class=p>)!=</span><span class=m>0</span> <span class=n>then</span>
        <span class=k>event</span> <span class=s>"i"</span><span class=p>,</span> <span class=m>2</span><span class=p>,</span> <span class=m>0</span><span class=p>,</span> <span class=m>3</span><span class=p>,</span> <span class=nf>cpsmidinn</span><span class=p>(</span><span class=m>72</span><span class=p>)</span>
    <span class=n>elseif</span> <span class=n>changed</span><span class=p>:</span><span class=nf>k</span><span class=p>(</span><span class=n>chnget</span><span class=p>:</span><span class=nf>k</span><span class=p>(</span><span class=s>"b3"</span><span class=p>))==</span><span class=m>1</span> <span class=p>&amp;&amp;</span> <span class=n>chnget</span><span class=p>:</span><span class=nf>k</span><span class=p>(</span><span class=s>"b3"</span><span class=p>)!=</span><span class=m>0</span> <span class=n>then</span>
        <span class=k>event</span> <span class=s>"i"</span><span class=p>,</span> <span class=m>2</span><span class=p>,</span> <span class=m>0</span><span class=p>,</span> <span class=m>3</span><span class=p>,</span> <span class=nf>cpsmidinn</span><span class=p>(</span><span class=m>71</span><span class=p>)</span>
    <span class=n>elseif</span> <span class=n>changed</span><span class=p>:</span><span class=nf>k</span><span class=p>(</span><span class=n>chnget</span><span class=p>:</span><span class=nf>k</span><span class=p>(</span><span class=s>"a3"</span><span class=p>))==</span><span class=m>1</span> <span class=p>&amp;&amp;</span> <span class=n>chnget</span><span class=p>:</span><span class=nf>k</span><span class=p>(</span><span class=s>"a3"</span><span class=p>)!=</span><span class=m>0</span> <span class=n>then</span>
        <span class=k>event</span> <span class=s>"i"</span><span class=p>,</span> <span class=m>2</span><span class=p>,</span> <span class=m>0</span><span class=p>,</span> <span class=m>3</span><span class=p>,</span> <span class=nf>cpsmidinn</span><span class=p>(</span><span class=m>69</span><span class=p>)</span>
    <span class=n>elseif</span> <span class=n>changed</span><span class=p>:</span><span class=nf>k</span><span class=p>(</span><span class=n>chnget</span><span class=p>:</span><span class=nf>k</span><span class=p>(</span><span class=s>"g3"</span><span class=p>))==</span><span class=m>1</span> <span class=p>&amp;&amp;</span> <span class=n>chnget</span><span class=p>:</span><span class=nf>k</span><span class=p>(</span><span class=s>"g3"</span><span class=p>)!=</span><span class=m>0</span> <span class=n>then</span>
        <span class=k>event</span> <span class=s>"i"</span><span class=p>,</span> <span class=m>2</span><span class=p>,</span> <span class=m>0</span><span class=p>,</span> <span class=m>3</span><span class=p>,</span> <span class=nf>cpsmidinn</span><span class=p>(</span><span class=m>67</span><span class=p>)</span>
    <span class=n>elseif</span> <span class=n>changed</span><span class=p>:</span><span class=nf>k</span><span class=p>(</span><span class=n>chnget</span><span class=p>:</span><span class=nf>k</span><span class=p>(</span><span class=s>"f3"</span><span class=p>))==</span><span class=m>1</span> <span class=p>&amp;&amp;</span> <span class=n>chnget</span><span class=p>:</span><span class=nf>k</span><span class=p>(</span><span class=s>"f3"</span><span class=p>)!=</span><span class=m>0</span> <span class=n>then</span>
        <span class=k>event</span> <span class=s>"i"</span><span class=p>,</span> <span class=m>2</span><span class=p>,</span> <span class=m>0</span><span class=p>,</span> <span class=m>3</span><span class=p>,</span> <span class=nf>cpsmidinn</span><span class=p>(</span><span class=m>65</span><span class=p>)</span>
    <span class=n>elseif</span> <span class=n>changed</span><span class=p>:</span><span class=nf>k</span><span class=p>(</span><span class=n>chnget</span><span class=p>:</span><span class=nf>k</span><span class=p>(</span><span class=s>"e3"</span><span class=p>))==</span><span class=m>1</span> <span class=p>&amp;&amp;</span> <span class=n>chnget</span><span class=p>:</span><span class=nf>k</span><span class=p>(</span><span class=s>"e3"</span><span class=p>)!=</span><span class=m>0</span> <span class=n>then</span>
        <span class=k>event</span> <span class=s>"i"</span><span class=p>,</span> <span class=m>2</span><span class=p>,</span> <span class=m>0</span><span class=p>,</span> <span class=m>3</span><span class=p>,</span> <span class=nf>cpsmidinn</span><span class=p>(</span><span class=m>64</span><span class=p>)</span>
    <span class=n>elseif</span> <span class=n>changed</span><span class=p>:</span><span class=nf>k</span><span class=p>(</span><span class=n>chnget</span><span class=p>:</span><span class=nf>k</span><span class=p>(</span><span class=s>"d3"</span><span class=p>))==</span><span class=m>1</span> <span class=p>&amp;&amp;</span> <span class=n>chnget</span><span class=p>:</span><span class=nf>k</span><span class=p>(</span><span class=s>"d3"</span><span class=p>)!=</span><span class=m>0</span> <span class=n>then</span>
        <span class=k>event</span> <span class=s>"i"</span><span class=p>,</span> <span class=m>2</span><span class=p>,</span> <span class=m>0</span><span class=p>,</span> <span class=m>3</span><span class=p>,</span> <span class=nf>cpsmidinn</span><span class=p>(</span><span class=m>62</span><span class=p>)</span>
    <span class=n>elseif</span> <span class=n>changed</span><span class=p>:</span><span class=nf>k</span><span class=p>(</span><span class=n>chnget</span><span class=p>:</span><span class=nf>k</span><span class=p>(</span><span class=s>"c3"</span><span class=p>))==</span><span class=m>1</span> <span class=p>&amp;&amp;</span> <span class=n>chnget</span><span class=p>:</span><span class=nf>k</span><span class=p>(</span><span class=s>"c3"</span><span class=p>)!=</span><span class=m>0</span> <span class=n>then</span>
        <span class=k>event</span> <span class=s>"i"</span><span class=p>,</span> <span class=m>2</span><span class=p>,</span> <span class=m>0</span><span class=p>,</span> <span class=m>3</span><span class=p>,</span> <span class=nf>cpsmidinn</span><span class=p>(</span><span class=m>60</span><span class=p>)</span>
    <span class=n>endif</span>

<span class=n>endin</span>

<span class=p>;</span><span class=n>simple</span> <span class=n>synthesiser</span> 
<span class=n>instr</span> <span class=m>2</span>
    <span class=n>print</span> <span class=n>p1</span>
    <span class=n>a1</span> <span class=n>expon</span> <span class=n>chnget</span><span class=p>:</span><span class=nf>i</span><span class=p>(</span><span class=s>"gain"</span><span class=p>),</span> <span class=n>p3</span><span class=p>,</span> <span class=m>0.001</span>
    <span class=n>a2</span> <span class=n>oscili</span> <span class=n>a1</span><span class=p>,</span> <span class=n>p4</span>
    <span class=n>outs</span> <span class=n>a2</span><span class=p>,</span> <span class=n>a2</span>
<span class=n>endin</span>

<span class=p>&lt;/</span><span class=n>CsInstruments</span><span class=p>&gt;</span>  
<span class=p>&lt;</span><span class=n>CsScore</span><span class=p>&gt;</span>
<span class=n>i1</span> <span class=m>0</span> <span class=m>5000</span>
<span class=p>&lt;/</span><span class=n>CsScore</span><span class=p>&gt;</span>
<span class=p>&lt;/</span><span class=n>CsoundSynthesizer</span><span class=p>&gt;</span>
</code></pre></div> <p><img src="../../images/docs/newWidgetFinished.gif"></p> </div> </article> <div class=doc-link-wrapper> <a href="../new_widgets_part_2/index.html" class="doc-link left-link" title="Previous Doc"><i class="icon icon-left-open"></i></a> <span class="doc-link right-link disabled"><i class="icon icon-right-open"></i></span> </div> <div class=clear></div> </div> </div> </div> <a href="index.html#0" class=back-to-top></a> <script src="../../scripts/vendor.js"></script> <script src="../../scripts/main.js"></script>  <script>
      (function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=
      function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;
      e=o.createElement(i);r=o.getElementsByTagName(i)[0];
      e.src='https://www.google-analytics.com/analytics.js';
      r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));
      ga('create','UA-74283643-1');ga('send','pageview');
    </script> </body> </html> 
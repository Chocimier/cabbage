<!DOCTYPE html> <html lang=en> <head> <meta charset=utf-8> <meta http-equiv=X-UA-Compatible content="IE=edge"> <meta name=viewport content="width=device-width, initial-scale=1"> <title>Managing Large Numbers Of Widgets | Cabbage Audio</title> <meta name=description content="Cabbage is a framework for audio software development. Using simple markup text and the Csound audio synthesis language users can target four major operating..."> <link rel=canonical href="index.html"> <link rel=alternate type=application/rss+xml title="Cabbage Audio" href=http://cabbageaudio.com/feed.xml> <link rel=apple-touch-icon sizes=57x57 href=http://cabbageaudio.com/apple-touch-icon-57x57.png> <link rel=apple-touch-icon sizes=60x60 href=http://cabbageaudio.com/apple-touch-icon-60x60.png> <link rel=apple-touch-icon sizes=72x72 href=http://cabbageaudio.com/apple-touch-icon-72x72.png> <link rel=apple-touch-icon sizes=76x76 href=http://cabbageaudio.com/apple-touch-icon-76x76.png> <link rel=apple-touch-icon sizes=114x114 href=http://cabbageaudio.com/apple-touch-icon-114x114.png> <link rel=apple-touch-icon sizes=120x120 href=http://cabbageaudio.com/apple-touch-icon-120x120.png> <link rel=apple-touch-icon sizes=144x144 href=http://cabbageaudio.com/apple-touch-icon-144x144.png> <link rel=apple-touch-icon sizes=152x152 href=http://cabbageaudio.com/apple-touch-icon-152x152.png> <link rel=apple-touch-icon sizes=180x180 href=http://cabbageaudio.com/apple-touch-icon-180x180.png> <link rel=icon type=image/png href=http://cabbageaudio.com/favicon-32x32.png sizes=32x32> <link rel=icon type=image/png href=http://cabbageaudio.com/favicon-194x194.png sizes=194x194> <link rel=icon type=image/png href=http://cabbageaudio.com/favicon-96x96.png sizes=96x96> <link rel=icon type=image/png href=http://cabbageaudio.com/android-chrome-192x192.png sizes=192x192> <link rel=icon type=image/png href=http://cabbageaudio.com/favicon-16x16.png sizes=16x16> <link rel=manifest href=http://cabbageaudio.com/manifest.json> <link rel=mask-icon href=http://cabbageaudio.com/safari-pinned-tab.svg color=#93d200> <meta name=apple-mobile-web-app-title content="Cabbage Audio"> <meta name=application-name content="Cabbage Audio"> <meta name=msapplication-TileColor content=#24b1f2> <meta name=msapplication-TileImage content=http://cabbageaudio.com/mstile-144x144.png> <meta name=theme-color content=#0391d1> <link rel=stylesheet href="../../styles/main.css"> </head> <body class=docs> <div class=wrapper> <header class=navigation role=banner> <div class=navigation-wrapper> <a href="http://cabbageaudio.com/" class=logo-header> <img src="../../images/cabbage_transparent.svg" alt="Cabbage Logo"> </a> <a href=javascript:void(0) class=navigation-menu-button id=js-mobile-menu>MENU</a> <nav role=navigation> <ul id=js-navigation-menu class="navigation-menu show"> <li class=nav-link> <a href="http://cabbageaudio.com/" title=Home>Home</a> </li> <li class=nav-link> <a href=http://cabbageaudio.com/#features title=Features>Features</a> </li> <li class=nav-link> <a href="http://cabbageaudio.com/download/" title=Download>Download</a> </li> <li class="nav-link more"> <a href="http://cabbageaudio.com/" title=Learning>Learning</a> <ul class=submenu> <li> <a href="../introduction/index.html" title=Docs>Docs</a> </li> <li> <a href="http://cabbageaudio.com/tutorials/" title=Videos>Videos</a> </li> </ul> </li> <li class=nav-link> <a href="http://cabbageaudio.com/faq/" title=FAQ>FAQ</a> </li> <li class=nav-link> <a href=http://forum.cabbageaudio.com title=Forum target=_blank>Forum</a> </li> </ul> </nav> </div> </header> <!--[if lt IE 11]>
 <p class="browserupgrade">You are using an <strong>outdated</strong> browser. The CabbageAudio site may not display correctly. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
 <![endif]--> <aside class=doc-nav> <nav role=navigation id=doc-menu> <h3>Cabbage Docs</h3> <hr> <ul> <li> <a href=http://cabbageaudio.com/docs/intro class=sub-menu-trigger> <i class=icon-right-open></i>&nbsp; Quickstart </a> <ul class=submenu> <li><a href="../introduction/index.html">Introduction</a></li> <li><a href="../standalone_host/index.html">Standalone Host</a></li> <li><a href="../first_synth/index.html">First Synth</a></li> <li><a href="../controlling/index.html">Controlling</a></li> <li><a href="../first_effect/index.html">First Effect</a></li> <li><a href="../exporting/index.html">Exporting</a></li> <li><a href="../distributing/index.html">Distributing</a></li> <li><a href="../cabbage_studio/index.html">Cabbage Studio</a></li> <li><a href="../android/index.html">Android</a></li> <li><a href="../cabbage_audio_unit/index.html">Cabbage Audio Unit</a></li> </ul> </li> </ul> <ul> <li> <a href=http://cabbageaudio.com class=sub-menu-trigger> <i class=icon-right-open></i>&nbsp; Cabbage Widgets </a> <ul class=submenu> <li><a href="../cabbage_syntax/index.html">Cabbage Syntax</a></li> <li><a href="../button/index.html">Button</a></li> <li><a href="../button_file/index.html">Button File</a></li> <li><a href="../button_info/index.html">Button Info</a></li> <li><a href="../checkbox/index.html">Checkbox</a></li> <li><a href="../combobox/index.html">Combobox</a></li> <li><a href="../csound_output/index.html">Csound Output</a></li> <li><a href="../encoder/index.html">Encoder</a></li> <li><a href="../gentable/index.html">Gentable</a></li> <li><a href="../hrange/index.html">Hrange</a></li> <li><a href="../fftdisplay/index.html">Fftdisplay</a></li> <li><a href="../form/index.html">Form</a></li> <li><a href="../groupbox/index.html">Groupbox</a></li> <li><a href="../image/index.html">Image</a></li> <li><a href="../keyboard/index.html">Keyboard</a></li> <li><a href="../label/index.html">Label</a></li> <li><a href="../numberbox/index.html">Numberbox</a></li> <li><a href="../sliders/index.html">Sliders</a></li> <li><a href="../soundfiler/index.html">Soundfiler</a></li> <li><a href="../table/index.html">Table</a></li> <li><a href="../textbox/index.html">Textbox</a></li> <li><a href="../texteditor/index.html">Texteditor</a></li> <li><a href="../vrange/index.html">Vrange</a></li> <li><a href="../xypad/index.html">Xypad</a></li> </ul> </li> </ul> <ul class=active-sub-item> <li> <a href=http://cabbageaudio.com class=sub-menu-trigger> <i class="icon-right-open active-sub-item"></i>&nbsp; Extras </a> <ul class=submenu> <li><a href="../identchannels/index.html">Identchannels</a></li> <li><a href="../plants/index.html">Plants</a></li> <li><a href="../presets/index.html">Presets</a></li> <li><a href="../gui_designer/index.html">Gui Designer</a></li> <li><a href="../widget_arrays/index.html">Widget Arrays</a></li> <li class=current><a href="index.html">Managing Large Numbers Of Widgets</a></li> <li><a href="../macros_and_reserved_channels/index.html">Macros And Reserved Channels</a></li> <li><a href="../using_svgs/index.html">Using Svgs</a></li> </ul> </li> </ul> <ul class=active-sub-item> <li> <a href=http://cabbageaudio.com class=sub-menu-trigger> <i class="icon-right-open active-sub-item"></i>&nbsp; Csound </a> <ul class=submenu> <li><a href="../csound_syntax/index.html">Csound Syntax</a></li> <li><a href="../keywords/index.html">Keywords</a></li> <li><a href="../contants_and_variables/index.html">Contants And Variables</a></li> <li><a href="../opcodes/index.html">Opcodes</a></li> <li><a href="../operators_and_comments/index.html">Operators And Comments</a></li> <li><a href="../beginner_synth/index.html">Beginner Synth</a></li> </ul> </li> </ul> <ul class=active-sub-item> <li> <a href=http://cabbageaudio.com class=sub-menu-trigger> <i class="icon-right-open active-sub-item"></i>&nbsp; Extending Cabbage </a> <ul class=submenu> <li><a href="../new_widgets_part_1/index.html">New Widgets Part 1</a></li> <li><a href="../new_widgets_part_2/index.html">New Widgets Part 2</a></li> <li><a href="../new_widgets_part_3/index.html">New Widgets Part 3</a></li> </ul> </li> </ul> </nav> </aside> <div class=doc-content> <i class="toggle-nav icon icon-menu">&#xe81b;</i> <div class=container> <article class=post>  <div class=post-content> <h1>Managing large numbers of widgets</h1> <p>It can seem like a lot of work at times to deal with large numbers of widgets, but with a little thought and consideration things can be made a lot easier. The previous instrument (see <a href="http://cabbageaudio.com/docs/managing_large_numbers_of_widgets/widget_arrays.md">WidgetArrays</a>) will serve as a good starting point to explore this topic. </p> <p>The <a href="http://cabbageaudio.com/docs/managing_large_numbers_of_widgets/widget_arrays.md">WidgetArrays</a> example dynamically created and positioned 100 check box widgets to the screen. So let&#39;s say that we want to turn the matrix of check boxes into a simple step sequencer. To do so we will need to check the value of each check box in each column at a set rate. The long way to do this would be to test the state of each check box manually on every k-cycle. The code for that might look like this.</p> <blockquote> <p>Note that the Csound code presented in this section will only work with Csound 6.07 onwards due to changes made in how array opcodes are handled during looping operations. Cabbage prints the current version of Csound in the console windows on startup. You can check there which version is installed. </p> </blockquote> <div class=highlight><pre><code class=language-csharp data-lang=csharp><span class=n>instr</span> <span class=m>1</span>
<span class=n>k1</span> <span class=n>chnget</span> <span class=s>"checkbox1"</span>
<span class=n>k2</span> <span class=n>chnget</span> <span class=s>"checkbox2"</span>
<span class=n>k3</span> <span class=n>chnget</span> <span class=s>"checkbox3"</span>
<span class=n>k4</span> <span class=n>chnget</span> <span class=s>"checkbox4"</span>
<span class=n>k5</span> <span class=n>chnget</span> <span class=s>"checkbox5"</span>
<span class=n>k6</span> <span class=n>chnget</span> <span class=s>"checkbox6"</span>
<span class=n>k7</span> <span class=n>chnget</span> <span class=s>"checkbox7"</span>
<span class=n>k8</span> <span class=n>chnget</span> <span class=s>"checkbox8"</span>
<span class=n>k9</span> <span class=n>chnget</span> <span class=s>"checkbox9"</span>
<span class=n>k10</span> <span class=n>chnget</span> <span class=s>"checkbox10"</span>
<span class=c1>//todo add variables for the next 90 checkboxes...
</span><span class=p>(...)</span>
</code></pre></div> <p>The above code will provide the values of the first 10 check boxes. We would need to then add 90 more calls to <code>chnget</code> to get the values of the remaining check boxes. That&#39;s obviously a very long way of doing things. </p> <p>If, however, the channel names are consistent and use numbers then it is easy to use an array to hold the value of each widget. Because we used a widget array to create the widgets, we know that each channel will have a number appended to it that goes from 1 to the number of widgets. We can easily use a <code>sprintfk</code> opcode to generate our channels names while we run through a while loop. </p> <div class=highlight><pre><code class=language-csharp data-lang=csharp><span class=p>(...)</span>
<span class=n>kSteps</span><span class=p>[]</span> <span class=n>init</span> <span class=m>100</span>
<span class=n>kIndex</span> <span class=p>=</span> <span class=m>0</span>
<span class=k>while</span> <span class=n>kIndex</span><span class=p>&lt;</span><span class=m>100</span> <span class=k>do</span>
    <span class=n>kSteps</span><span class=p>[</span><span class=n>kIndex</span><span class=p>]</span> <span class=n>chnget</span> <span class=nf>sprintfk</span><span class=p>(</span><span class=s>"step%d"</span><span class=p>,</span> <span class=n>kIndex</span><span class=p>+</span><span class=m>1</span><span class=p>)</span>
    <span class=n>kIndex</span> <span class=p>=</span> <span class=n>kIndex</span><span class=p>+</span><span class=m>1</span>
<span class=nf>od</span> 
<span class=p>(...)</span>
</code></pre></div> <p>In the code presented above, the array <code>kSteps[]</code> will be filled with the value of each channel, ranging from the channel named <code>step1</code> to <code>step100</code>. The values of each channel are written to each index of the <code>kSteps[]</code> on every k-cycle. If a user presses one of the on-screen check boxes, the kSteps array will update. </p> <p>Following this we need to check the values of each index of the kSteps array. If any of them are set to 1 we can trigger a note. Of course we will need to deal with the check boxes on a column by column basis. </p> <p>Introducing a metro opcode to count each column will provide us with a step counter. We then need to check each check box in each column, one after another in time with the metro opcode. Something like this will work nicely:</p> <div class=highlight><pre><code class=language-csharp data-lang=csharp><span class=n>kColumn</span> <span class=n>init</span> <span class=m>0</span>
<span class=n>kRow</span> <span class=p>=</span> <span class=m>0</span>
<span class=k>if</span> <span class=nf>metro</span><span class=p>(</span><span class=m>1</span><span class=p>)==</span><span class=m>1</span> <span class=n>then</span>
    <span class=n>kColumn</span> <span class=p>=</span> <span class=n>kColumn</span><span class=p>&lt;</span><span class=m>9</span> <span class=p>?</span> <span class=n>kColumn</span><span class=p>+</span><span class=m>1</span> <span class=p>:</span> <span class=m>0</span>
    <span class=k>while</span> <span class=n>kRow</span><span class=p>&lt;</span><span class=m>100</span> <span class=k>do</span>
            <span class=k>if</span> <span class=n>kSteps</span><span class=p>[</span><span class=n>kRow</span><span class=p>+</span><span class=n>kColumn</span><span class=p>]==</span><span class=m>1</span> <span class=n>then</span>
                <span class=k>event</span> <span class=s>"i"</span><span class=p>,</span> <span class=m>1000</span><span class=p>,</span> <span class=m>0</span><span class=p>,</span> <span class=m>1</span><span class=p>,</span>  <span class=p>(</span><span class=n>kRow</span><span class=p>+</span><span class=m>10</span><span class=p>)*</span><span class=m>10</span>
            <span class=n>endif</span>  
        <span class=n>kRow</span> <span class=p>=</span> <span class=n>kRow</span><span class=p>+</span><span class=m>10</span>
    <span class=n>od</span>      
<span class=n>endif</span> 
</code></pre></div> <p>kColumn will increment by one every second. When it does, we check the corresponding vertical column of check boxes for ones that are on. If they are on, we trigger instrument 1000 to play. We pass <code>(kRow+10)*10</code> as the frequency for each instance of instr 1000 that is triggered. In this case instrument 1000 is a very simple synthesier, but it could be as complex an instrument as you wish to make it. </p> <p>Provided below is the complete source code for a very simple step sequencer. Although it use 100 on-screen widgets, An impressively small amount of code is needed in order to create something quite musical. </p> <div class=highlight><pre><code class=language-csharp data-lang=csharp><span class=p>&lt;</span><span class=n>Cabbage</span><span class=p>&gt;</span>
<span class=n>form</span> <span class=nf>size</span><span class=p>(</span><span class=m>260</span><span class=p>,</span> <span class=m>290</span><span class=p>),</span> <span class=nf>caption</span><span class=p>(</span><span class=s>""</span><span class=p>),</span> <span class=nf>colour</span><span class=p>(</span><span class=m>55</span><span class=p>,</span> <span class=m>110</span><span class=p>,</span> <span class=m>185</span><span class=p>)</span> <span class=nf>pluginID</span><span class=p>(</span><span class=s>"plu1"</span><span class=p>)</span>
<span class=n>checkbox</span> <span class=nf>bounds</span><span class=p>(-</span><span class=m>100</span><span class=p>,</span> <span class=p>-</span><span class=m>100</span><span class=p>,</span> <span class=m>25</span><span class=p>,</span> <span class=m>25</span><span class=p>),</span> <span class=nf>text</span><span class=p>(</span><span class=s>""</span><span class=p>),</span> <span class=nf>widgetarray</span><span class=p>(</span><span class=s>"step"</span><span class=p>,</span> <span class=m>100</span><span class=p>),</span> <span class=k>value</span><span class=p>(</span><span class=m>0</span><span class=p>)</span>
<span class=p>&lt;/</span><span class=n>Cabbage</span><span class=p>&gt;</span>
<span class=p>&lt;</span><span class=n>CsoundSynthesizer</span><span class=p>&gt;</span>
<span class=p>&lt;</span><span class=n>CsOptions</span><span class=p>&gt;</span>
<span class=p>-</span><span class=n>n</span> <span class=p>-</span><span class=n>d</span> <span class=p>-+</span><span class=n>rtmidi</span><span class=p>=</span><span class=n>NULL</span> <span class=p>-</span><span class=n>M0</span> <span class=p>-</span><span class=n>m0d</span> <span class=p>--</span><span class=n>midi</span><span class=p>-</span><span class=n>key</span><span class=p>=</span><span class=m>4</span>
<span class=p>&lt;/</span><span class=n>CsOptions</span><span class=p>&gt;</span>
<span class=p>&lt;</span><span class=n>CsInstruments</span><span class=p>&gt;</span>
<span class=n>sr</span> <span class=p>=</span> <span class=m>44100</span>
<span class=n>ksmps</span> <span class=p>=</span> <span class=m>64</span>
<span class=n>nchnls</span> <span class=p>=</span> <span class=m>2</span>
<span class=m>0d</span><span class=n>bfs</span><span class=p>=</span><span class=m>1</span>

<span class=n>instr</span> <span class=m>2</span>
<span class=n>kSteps</span><span class=p>[]</span> <span class=n>init</span> <span class=m>100</span>
<span class=n>kIndex</span> <span class=p>=</span> <span class=m>0</span>
<span class=n>kColumn</span> <span class=n>init</span> <span class=m>0</span>
<span class=n>kRow</span> <span class=p>=</span> <span class=m>0</span>

<span class=k>while</span> <span class=n>kIndex</span><span class=p>&lt;</span><span class=m>100</span> <span class=k>do</span>
    <span class=n>kSteps</span><span class=p>[</span><span class=n>kIndex</span><span class=p>]</span> <span class=n>chnget</span> <span class=nf>sprintfk</span><span class=p>(</span><span class=s>"step%d"</span><span class=p>,</span> <span class=n>kIndex</span><span class=p>+</span><span class=m>1</span><span class=p>)</span>
    <span class=n>kIndex</span> <span class=p>=</span> <span class=n>kIndex</span><span class=p>+</span><span class=m>1</span>
<span class=n>od</span>

<span class=k>if</span> <span class=nf>metro</span><span class=p>(</span><span class=m>2</span><span class=p>)==</span><span class=m>1</span> <span class=n>then</span>
    <span class=n>kColumn</span> <span class=p>=</span> <span class=n>kColumn</span><span class=p>&lt;</span><span class=m>9</span> <span class=p>?</span> <span class=n>kColumn</span><span class=p>+</span><span class=m>1</span> <span class=p>:</span> <span class=m>0</span>
    <span class=k>while</span> <span class=n>kRow</span><span class=p>&lt;</span><span class=m>100</span> <span class=k>do</span>
            <span class=k>if</span> <span class=n>kSteps</span><span class=p>[</span><span class=n>kRow</span><span class=p>+</span><span class=n>kColumn</span><span class=p>]==</span><span class=m>1</span> <span class=n>then</span>
                <span class=k>event</span> <span class=s>"i"</span><span class=p>,</span> <span class=m>1000</span><span class=p>,</span> <span class=m>0</span><span class=p>,</span> <span class=m>1</span><span class=p>,</span>  <span class=p>(</span><span class=n>kRow</span><span class=p>+</span><span class=m>10</span><span class=p>)*</span><span class=m>10</span>
            <span class=n>endif</span>  
        <span class=n>kRow</span> <span class=p>=</span> <span class=n>kRow</span><span class=p>+</span><span class=m>10</span>
    <span class=n>od</span>      
<span class=n>endif</span>            
<span class=n>endin</span>

<span class=n>instr</span> <span class=m>1000</span>
<span class=n>a1</span> <span class=n>expon</span> <span class=p>.</span><span class=m>2</span><span class=p>,</span> <span class=n>p3</span><span class=p>,</span> <span class=p>.</span><span class=m>0001</span>
<span class=n>a2</span> <span class=n>oscili</span> <span class=n>a1</span><span class=p>,</span> <span class=n>p4</span>
<span class=n>outs</span> <span class=n>a2</span><span class=p>,</span> <span class=n>a2</span>
<span class=n>endin</span>

<span class=n>instr</span> <span class=m>1</span>
<span class=n>iCnt</span> <span class=n>init</span> <span class=m>0</span>
<span class=n>iCntRows</span> <span class=n>init</span> <span class=m>0</span>
<span class=n>kMetro</span> <span class=n>metro</span> <span class=m>1</span>
<span class=n>until</span> <span class=n>iCnt</span> <span class=p>&gt;</span> <span class=m>100</span> <span class=k>do</span>
    <span class=n>S1</span> <span class=n>sprintf</span> <span class=s>"pos(%d, %d)"</span><span class=p>,</span> <span class=n>iCnt</span><span class=p>%</span><span class=m>10</span><span class=p>*</span><span class=m>25</span><span class=p>+</span><span class=m>5</span><span class=p>,</span> <span class=n>iCntRows</span><span class=p>*</span><span class=m>25</span>
    <span class=n>S2</span> <span class=n>sprintf</span> <span class=s>"step_ident%d"</span><span class=p>,</span> <span class=n>iCnt</span><span class=p>+</span><span class=m>1</span>
    <span class=n>chnset</span> <span class=n>S1</span><span class=p>,</span> <span class=n>S2</span>
    <span class=n>iCnt</span><span class=p>=</span><span class=n>iCnt</span><span class=p>+</span><span class=m>1</span>
    <span class=n>iCntRows</span> <span class=p>=</span> <span class=p>(</span><span class=n>iCnt</span><span class=p>%</span><span class=m>10</span><span class=p>==</span><span class=m>0</span> <span class=p>?</span> <span class=n>iCntRows</span><span class=p>+</span><span class=m>1</span> <span class=p>:</span> <span class=n>iCntRows</span><span class=p>)</span>
<span class=n>enduntil</span>
<span class=n>endin</span>


<span class=p>&lt;/</span><span class=n>CsInstruments</span><span class=p>&gt;</span>  
<span class=p>&lt;</span><span class=n>CsScore</span><span class=p>&gt;</span> 
<span class=n>i1</span> <span class=m>0</span> <span class=m>1</span>
<span class=n>i2</span> <span class=m>1</span> <span class=m>1000</span>
<span class=p>&lt;/</span><span class=n>CsScore</span><span class=p>&gt;</span>
<span class=p>&lt;/</span><span class=n>CsoundSynthesizer</span><span class=p>&gt;</span>
</code></pre></div> </div> </article> <div class=doc-link-wrapper> <a href="../widget_arrays/index.html" class="doc-link left-link" title="Previous Doc"><i class="icon icon-left-open"></i></a> <a href="../macros_and_reserved_channels/index.html" class="doc-link right-link" title="Next Doc"><i class="icon icon-right-open"></i></a> </div> <div class=clear></div> </div> </div> </div> <a href="index.html#0" class=back-to-top></a> <script src="../../scripts/vendor.js"></script> <script src="../../scripts/main.js"></script>  <script>
      (function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=
      function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;
      e=o.createElement(i);r=o.getElementsByTagName(i)[0];
      e.src='https://www.google-analytics.com/analytics.js';
      r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));
      ga('create','UA-74283643-1');ga('send','pageview');
    </script> </body> </html> 
<!DOCTYPE HTML>
<html lang="en" >
    
    <head>
        
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>Part 3 | Cabbage quickstart and Reference Manual</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 2.1.0">
        
        
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">
        
    <link rel="stylesheet" href="gitbook/style.css">
    
    

        
    
    
    
    <link rel="prev" href="./new_widgets_part_2.html" />
    

        
    </head>
    <body>
        
        
    <div class="book" data-level="5.3" data-basepath="." data-revision="Mon Mar 28 2016 17:36:42 GMT+0100 (IST)">
    

<div class="book-summary">
    <div class="book-search">
        <input type="text" placeholder="Type to search" class="form-control" />
    </div>
    <ul class="summary">
        
        
        
        

        

        
    
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="./index.html">
                        <i class="fa fa-check"></i>
                        
                        Introduction
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="1" data-path="introduction.html">
            
                
                    <a href="./introduction.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                        Quick start
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1" data-path="first_synth.html">
            
                
                    <a href="./first_synth.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.1.</b>
                        
                        First synth
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="controlling.html">
            
                
                    <a href="./controlling.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.2.</b>
                        
                        Controlling your instrument
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="first_effect.html">
            
                
                    <a href="./first_effect.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.3.</b>
                        
                        First effect
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="exporting.html">
            
                
                    <a href="./exporting.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.4.</b>
                        
                        Exporting instruments as plugins
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="distributing.html">
            
                
                    <a href="./distributing.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.5.</b>
                        
                        Distributing instruments
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2" data-path="cabbage_syntax.html">
            
                
                    <a href="./cabbage_syntax.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                        Widget Reference
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1" data-path="button.html">
            
                
                    <a href="./button.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.</b>
                        
                        Button
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="button_file.html">
            
                
                    <a href="./button_file.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.2.</b>
                        
                        Button(File)
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="button_info.html">
            
                
                    <a href="./button_info.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.3.</b>
                        
                        Button(Info)
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="2.4" data-path="checkbox.html">
            
                
                    <a href="./checkbox.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.4.</b>
                        
                        Checkbox
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="2.5" data-path="combobox.html">
            
                
                    <a href="./combobox.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.5.</b>
                        
                        Combobox
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="2.6" data-path="csound_output.html">
            
                
                    <a href="./csound_output.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.6.</b>
                        
                        Csound Output
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="2.7" data-path="encoder.html">
            
                
                    <a href="./encoder.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.7.</b>
                        
                        Endless encoder
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="2.8" data-path="gentable.html">
            
                
                    <a href="./gentable.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.8.</b>
                        
                        Gentable
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="2.9" data-path="fftdisplay.html">
            
                
                    <a href="./fftdisplay.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.9.</b>
                        
                        FFTDisplay
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="2.10" data-path="form.html">
            
                
                    <a href="./form.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.10.</b>
                        
                        Form
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="2.11" data-path="groupbox.html">
            
                
                    <a href="./groupbox.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.11.</b>
                        
                        Groupbox
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="2.12" data-path="image.html">
            
                
                    <a href="./image.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.12.</b>
                        
                        Image
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="2.13" data-path="keyboard.html">
            
                
                    <a href="./keyboard.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.13.</b>
                        
                        Keyboard
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="2.14" data-path="label.html">
            
                
                    <a href="./label.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.14.</b>
                        
                        Labels
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="2.15" data-path="listbox.html">
            
                
                    <a href="./listbox.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.15.</b>
                        
                        Listbox
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="2.16" data-path="sliders.html">
            
                
                    <a href="./sliders.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.16.</b>
                        
                        Sliders
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="2.17" data-path="hrange.html">
            
                
                    <a href="./hrange.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.17.</b>
                        
                        Hrange
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="2.18" data-path="vrange.html">
            
                
                    <a href="./vrange.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.18.</b>
                        
                        Vrange
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="2.19" data-path="soundfiler.html">
            
                
                    <a href="./soundfiler.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.19.</b>
                        
                        Soundfiler
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="2.20" data-path="table.html">
            
                
                    <a href="./table.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.20.</b>
                        
                        Table (Deprecated)
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="2.21" data-path="textbox.html">
            
                
                    <a href="./textbox.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.21.</b>
                        
                        Textbox
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="2.22" data-path="texteditor.html">
            
                
                    <a href="./texteditor.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.22.</b>
                        
                        Texteditor
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="2.23" data-path="xypad.html">
            
                
                    <a href="./xypad.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.23.</b>
                        
                        XY Pad
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3" data-path="extras.html">
            
                
                    <a href="./extras.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                        Extras
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1" data-path="gui_designer.html">
            
                
                    <a href="./gui_designer.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.1.</b>
                        
                        GUI Designer
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="plants.html">
            
                
                    <a href="./plants.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.2.</b>
                        
                        Plants
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="3.3" data-path="identchannels.html">
            
                
                    <a href="./identchannels.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.3.</b>
                        
                        Identifier channels
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="3.4" data-path="presets.html">
            
                
                    <a href="./presets.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.4.</b>
                        
                        Presets
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="3.5" data-path="widget_arrays.html">
            
                
                    <a href="./widget_arrays.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.5.</b>
                        
                        Widget arrays
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="3.6" data-path="macros_and_reserved_channels.html">
            
                
                    <a href="./macros_and_reserved_channels.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.6.</b>
                        
                        Reserved channels and Macros
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="3.7" data-path="managing_large_numbers_of_widgets.html">
            
                
                    <a href="./managing_large_numbers_of_widgets.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.7.</b>
                        
                        Managing large numbers of Widgets
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="3.8" data-path="using_svgs.html">
            
                
                    <a href="./using_svgs.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.8.</b>
                        
                        Using SVGs
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="3.9" data-path="android.html">
            
                
                    <a href="./android.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.9.</b>
                        
                        Cabage on Android
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="3.10" data-path="cabbage_audio_unit.html">
            
                
                    <a href="./cabbage_audio_unit.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.10.</b>
                        
                        Cabage AudioUnit
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="3.11" data-path="standalone_host.html">
            
                
                    <a href="./standalone_host.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.11.</b>
                        
                        Standalone Standalone Host
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="3.12" data-path="cabbage_studio.html">
            
                
                    <a href="./cabbage_studio.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.12.</b>
                        
                        Cabbage Studio
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4" data-path="csound.html">
            
                
                    <a href="./csound.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.</b>
                        
                        Beginners
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1" data-path="file_structure_and_syntax.html">
            
                
                    <a href="./file_structure_and_syntax.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.1.</b>
                        
                        File Structure and Syntax
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="4.2" data-path="keywords.html">
            
                
                    <a href="./keywords.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.2.</b>
                        
                        Keywords
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="4.3" data-path="constants_and_variables.html">
            
                
                    <a href="./constants_and_variables.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.3.</b>
                        
                        Constants and Variables
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="4.4" data-path="opcodes.html">
            
                
                    <a href="./opcodes.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.4.</b>
                        
                        Opcodes
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="4.5" data-path="operators_and_comments.html">
            
                
                    <a href="./operators_and_comments.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.5.</b>
                        
                        Operators and Comments
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="4.6" data-path="beginner_synth.html">
            
                
                    <a href="./beginner_synth.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.6.</b>
                        
                        A simple Synthesiser
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5" data-path="add_new_widgets.html">
            
                
                    <a href="./add_new_widgets.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.</b>
                        
                        Adding new Widgets
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.1" data-path="new_widgets_part_1.html">
            
                
                    <a href="./new_widgets_part_1.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.1.</b>
                        
                        Part 1
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="5.2" data-path="new_widgets_part_2.html">
            
                
                    <a href="./new_widgets_part_2.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.2.</b>
                        
                        Part 2
                    </a>
                
            
            
        </li>
    
        <li class="chapter active" data-level="5.3" data-path="new_widgets_part_3.html">
            
                
                    <a href="./new_widgets_part_3.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.3.</b>
                        
                        Part 3
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    


        
        <li class="divider"></li>
        <li>
            <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
                Published with GitBook
            </a>
        </li>
        
    </ul>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header">
    <!-- Actions Left -->
    <a href="#" class="btn pull-left toggle-summary" aria-label="Table of Contents"><i class="fa fa-align-justify"></i></a>
    <a href="#" class="btn pull-left toggle-search" aria-label="Search"><i class="fa fa-search"></i></a>
    
    <div id="font-settings-wrapper" class="dropdown pull-left">
        <a href="#" class="btn toggle-dropdown" aria-label="Font Settings"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
    <div class="dropdown-caret">
        <span class="caret-outer"></span>
        <span class="caret-inner"></span>
    </div>

    <div class="buttons">
        <button type="button" id="reduce-font-size" class="button size-2">A</button>
        <button type="button" id="enlarge-font-size" class="button size-2">A</button>
    </div>

    <div class="buttons font-family-list">
        <button type="button" data-font="0" class="button">Serif</button>
        <button type="button" data-font="1" class="button">Sans</button>
    </div>

    <div class="buttons color-theme-list">
        <button type="button" id="color-theme-preview-0" class="button size-3" data-theme="0">White</button>
        <button type="button" id="color-theme-preview-1" class="button size-3" data-theme="1">Sepia</button>
        <button type="button" id="color-theme-preview-2" class="button size-3" data-theme="2">Night</button>
    </div>
</div>

    </div>

    <!-- Actions Right -->
    
    <div class="dropdown pull-right">
        <a href="#" class="btn toggle-dropdown" aria-label="Share"><i class="fa fa-share-alt"></i>
        </a>
        <div class="dropdown-menu font-settings dropdown-left">
            <div class="dropdown-caret">
                <span class="caret-outer"></span>
                <span class="caret-inner"></span>
            </div>
            <div class="buttons">
                <button type="button" data-sharing="twitter" class="button">
                    Share on Twitter
                </button>
                <button type="button" data-sharing="google-plus" class="button">
                    Share on Google
                </button>
                <button type="button" data-sharing="facebook" class="button">
                    Share on Facebook
                </button>
                <button type="button" data-sharing="weibo" class="button">
                    Share on Weibo
                </button>
                <button type="button" data-sharing="instapaper" class="button">
                    Share on Instapaper
                </button>
            </div>
        </div>
    </div>
    

    
    <a href="#" target="_blank" class="btn pull-right google-plus-sharing-link sharing-link" data-sharing="google-plus" aria-label="Google"><i class="fa fa-google-plus"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right facebook-sharing-link sharing-link" data-sharing="facebook" aria-label="Facebook"><i class="fa fa-facebook"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right twitter-sharing-link sharing-link" data-sharing="twitter" aria-label="Twitter"><i class="fa fa-twitter"></i></a>
    
    
    


    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="./" >Cabbage quickstart and Reference Manual</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-">
                    
                        <h1 id="new-widgets-part-3">New Widgets, Part 3</h1>
<p>We now have a simple step sequencer that the user can click on to enable steps. They can also see which is the current step in the sequence. But it remains quite useless until we can get it to communicate with the underlying instance of Csound. Cabbage widgets communicate with Csound through the use of named channels. For example, whenever a sure moves a slider in Cabbage, the value of that slider gets sent to Csound over a named channel bus. Each widget that is capable of affecting change in a Csound instrument must have a channel associated with it. So our widget must also have an associated channel. We can retrieve the name of the channel by accessing the string passed to the channel identifier.  </p>
<pre><code class="lang-csharp">class CabbageStepper    :    public Component, public Timer
{
    String name, channel;
    float numberOfSteps;
    int stepBPM, currentStep;
    Colour colour;
    Array&lt;int&gt; stepStates;

    public:

    CabbageStepper (CabbageGUIType &amp;cAttr, CabbagePluginAudioProcessorEditor* _owner)
        : Component(), 
        owner(_owner),
        name(cAttr.getStringProp(CabbageIDs::name)),
        channel(cAttr.getStringProp(CabbageIDs::channel)),
        colour(Colour::fromString(cAttr.getStringProp(CabbageIDs::colour))),
        stepBPM(cAttr.getNumProp(&quot;stepbpm&quot;)),
        numberOfSteps(cAttr.getNumProp(&quot;numberofsteps&quot;)),
        currentStep(0)
    {
(...)
</code></pre>
<h3 id="sending-messages-to-csound-channels">Sending messages to Csound channels</h3>
<p>An instance of Csound is created in the CabbagePluginAudioProcessor class, but we don&apos;t need to access it directly. We need only add some messages to the outgoing messages which are stored in CabbagePluginAudioProcesso::messageQueue. To access our main AudioProcessror class we can call the CabbagePluginAudioProcessorEditor::getFilter() method. We can then add some messages to the outgoing queue. At every k-boundary Cabbage will send the messages to Csound, this ensures complete thread safety. The best place to add messages to our queue is in the <strong>timerCallback()</strong> function. </p>
<pre><code class="lang-csharp">void CabbageStepper::timerCallback()
{
    currentStep = currentStep&lt;11 ? currentStep+1 : 0;
    int valueToSendToCsound = stepStates[currentStep]==1 ? currentStep+1 : 0;
    owner-&gt;getFilter()-&gt;messageQueue.addOutgoingChannelMessageToQueue(channel, valueToSendToCsound, String::empty);
    repaint();
}
</code></pre>
<p><strong>addOutgoingChannelMessageToQueue(...)</strong> takes three parameters. The first parameter is the name of the channel to communicate with Csound on. The next parameter is the value to send, and the final parameter is the message type, which is only used for special message types. In most cases this can be set to an empty string. </p>
<p>With this final method in place, Cabbage will send messages to Csound on each step. It will send a 0 if the step is disabled, otherwise it will send the step index+1. In order to use this widget with a Csound instrument we can do something like this.  </p>
<pre><code class="lang-csharp">&lt;Cabbage&gt;
<span class="hljs-function">form <span class="hljs-title">size</span><span class="hljs-params">(<span class="hljs-number">500</span>, <span class="hljs-number">100</span>)</span>, <span class="hljs-title">caption</span><span class="hljs-params">(<span class="hljs-string">&quot;Stepper&quot;</span>)</span>, <span class="hljs-title">pluginID</span><span class="hljs-params">(<span class="hljs-string">&quot;plu1&quot;</span>)</span>, <span class="hljs-title">colour</span><span class="hljs-params">(<span class="hljs-number">57</span>, <span class="hljs-number">110</span>, <span class="hljs-number">185</span>)</span>
stepper <span class="hljs-title">bounds</span><span class="hljs-params">(<span class="hljs-number">10</span>, <span class="hljs-number">10</span>, <span class="hljs-number">480</span>, <span class="hljs-number">40</span>)</span>, <span class="hljs-title">channel</span><span class="hljs-params">(<span class="hljs-string">&quot;step1&quot;</span>)</span>, <span class="hljs-title">colour</span><span class="hljs-params">(<span class="hljs-string">&quot;white&quot;</span>)</span>, <span class="hljs-title">numberofsteps</span><span class="hljs-params">(<span class="hljs-number">12</span>)</span>, <span class="hljs-title">stepbpm</span><span class="hljs-params">(<span class="hljs-number">120</span>)</span>
&lt;/Cabbage&gt;
&lt;CsoundSynthesizer&gt;
&lt;CsOptions&gt; 
-m0d
&lt;/CsOptions&gt;
&lt;CsInstruments&gt;
sr </span>= <span class="hljs-number">44100</span>
ksmps = <span class="hljs-number">16</span>
nchnls = <span class="hljs-number">2</span>
<span class="hljs-number">0</span>dbfs=<span class="hljs-number">1</span>

instr <span class="hljs-number">1</span>
<span class="hljs-keyword">if</span> changed:k(chnget:k(<span class="hljs-string">&quot;step1&quot;</span>))==<span class="hljs-number">1</span> &amp;&amp; chnget:k(<span class="hljs-string">&quot;step1&quot;</span>)!=<span class="hljs-number">0</span> then
    <span class="hljs-keyword">event</span> <span class="hljs-string">&quot;i&quot;</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>, <span class="hljs-number">3</span>
endif
endin

instr <span class="hljs-number">2</span>
    print p1
    a1 expon <span class="hljs-number">1</span>, p3, <span class="hljs-number">0.001</span>
    a2 oscili a1, <span class="hljs-number">256</span>
    outs a2, a2
endin

&lt;/CsInstruments&gt;  
&lt;CsScore&gt;
i1 <span class="hljs-number">0</span> <span class="hljs-number">5000</span>
&lt;/CsScore&gt;
&lt;/CsoundSynthesizer&gt;
</code></pre>
<p>Whenever channel &quot;step1&quot; changes, and is not equal to 0, we trigger instr 2 to play a note. </p>
<h3 id="using-csound-to-control-our-widget">Using Csound to control our widget</h3>
<p>Our new stepper widget serves as a good example of how easy it is to add new widget types to Cabbage, but it&apos;s still not quite ready for public consumption. There are still quite a few additions we could make to enhance the widget and provide users with a greater level of control. Perhaps the most important thing is to provide users with a way of turning the sequencer on or off. We could simply add a check box to our widget that will turn it on or off, but this will inevitably leads to problems if you wish to stack several steppers on top of each other. It would be very frustrating for the end-user if they have to enable each stepper widget manually. A better approach would be to provide them with a way of turning the sequence on or off from Csound. We can do this using identifier channels. </p>
<p>The <strong>CabbagePluginAudioProcessor::updateGUIControls()</strong> method checks for incoming identifier strings from Csound and gets called at every k-cycle. Identifier strings can be sent to a Cabbage widget using the chnset opcode in Csound. Once a string is sent, Cabbage parses it and updates the widget accordingly. Each widget that accepts identifier strings needs to implement an update(...) function. If you browse through the <strong>CabbagePluginAudioProcessor::updateGUIControls()</strong> code you&apos;ll seeing the following conditional statement. </p>
<pre><code class="lang-csharp">    //sample stepper widget
    else if(checkForIdentifierMessage(getFilter()-&gt;getGUILayoutCtrls(i), &quot;stepper&quot;))
    {
        ((CabbageStepper*)layoutComps[i])-&gt;update(getFilter()-&gt;getGUILayoutCtrls(i));
        getFilter()-&gt;getGUILayoutCtrls(i).setStringProp(CabbageIDs::identchannelmessage, &quot;&quot;);
    }
</code></pre>
<p>The <strong>checkForIdentifierMessage(...)</strong> method checks for the existence of an identifier string for a particular widget type. If an incoming string identifier is found it calls the widget classes <strong>update(...)</strong> function.</p>
<h3 id="writing-an-update-function">Writing an update function</h3>
<p>The update function gets passed a CabbageGUIType class object which provides us with all the information we need in order to update out widget. If for example we want to allow users to update the widget&apos;s colour from Csound we might do something like this in our <strong>update(...)</strong> method.</p>
<pre><code class="lang-csharp">void CabbageStepper::update(CabbageGUIType cAttr)
{
    if(colour.toString()!=cAttr.getStringProp(&quot;colour&quot;))
    {
        colour = Colour::fromString(cAttr.getStringProp(&quot;colour&quot;));
    }
}
</code></pre>
<p>We can now change the colour of our widget using the following Cabbage/Csound code:</p>
<pre><code class="lang-csharp">&lt;Cabbage&gt;
<span class="hljs-function">form <span class="hljs-title">size</span><span class="hljs-params">(<span class="hljs-number">500</span>, <span class="hljs-number">150</span>)</span>, <span class="hljs-title">caption</span><span class="hljs-params">(<span class="hljs-string">&quot;Stepper&quot;</span>)</span>, <span class="hljs-title">pluginID</span><span class="hljs-params">(<span class="hljs-string">&quot;plu1&quot;</span>)</span>, <span class="hljs-title">colour</span><span class="hljs-params">(<span class="hljs-number">57</span>, <span class="hljs-number">110</span>, <span class="hljs-number">185</span>)</span>
stepper <span class="hljs-title">bounds</span><span class="hljs-params">(<span class="hljs-number">10</span>, <span class="hljs-number">10</span>, <span class="hljs-number">480</span>, <span class="hljs-number">40</span>)</span>, <span class="hljs-title">channel</span><span class="hljs-params">(<span class="hljs-string">&quot;step1&quot;</span>)</span>, <span class="hljs-title">colour</span><span class="hljs-params">(<span class="hljs-string">&quot;white&quot;</span>)</span>, <span class="hljs-title">numberofsteps</span><span class="hljs-params">(<span class="hljs-number">12</span>)</span>, <span class="hljs-title">stepbpm</span><span class="hljs-params">(<span class="hljs-number">120</span>)</span>, <span class="hljs-title">identchannel</span><span class="hljs-params">(<span class="hljs-string">&quot;stepIdent&quot;</span>)</span>
button <span class="hljs-title">bounds</span><span class="hljs-params">(<span class="hljs-number">12</span>, <span class="hljs-number">58</span>, <span class="hljs-number">120</span>, <span class="hljs-number">25</span>)</span>, <span class="hljs-title">channel</span><span class="hljs-params">(<span class="hljs-string">&quot;colourButton&quot;</span>)</span>, <span class="hljs-title">text</span><span class="hljs-params">(<span class="hljs-string">&quot;Change colour&quot;</span>)</span>
&lt;/Cabbage&gt;
&lt;CsoundSynthesizer&gt;
&lt;CsOptions&gt; 
-m0d
&lt;/CsOptions&gt;
&lt;CsInstruments&gt;
sr </span>= <span class="hljs-number">44100</span>
ksmps = <span class="hljs-number">16</span>
nchnls = <span class="hljs-number">2</span>
<span class="hljs-number">0</span>dbfs=<span class="hljs-number">1</span>

instr <span class="hljs-number">1</span>
<span class="hljs-keyword">if</span> changed:k(chnget:k(<span class="hljs-string">&quot;colourButton&quot;</span>))==<span class="hljs-number">1</span> then
    <span class="hljs-keyword">if</span> chnget:k(<span class="hljs-string">&quot;colourButton&quot;</span>)==<span class="hljs-number">1</span> then
         chnset <span class="hljs-string">&quot;colour(255, 255, 0)&quot;</span>, <span class="hljs-string">&quot;stepIdent&quot;</span>
    <span class="hljs-keyword">else</span>
         chnset <span class="hljs-string">&quot;colour(255, 255, 255)&quot;</span>, <span class="hljs-string">&quot;stepIdent&quot;</span>
    <span class="hljs-function">endif
<span class="hljs-title">endif</span>

<span class="hljs-params">(...)</span>
</span></code></pre>
<p><img src="images/newWidgetColourUpdate.gif" alt="NewWidget3"></p>
<p>It won&apos;t take much to update our <strong>update()</strong> function so that users can turn the step sequencer on and off, as well as control the tempo. We will need to add a new member variable to hold the running state of the widget. We can call it <strong>isRunning</strong>, and we will let users use the pre-existing <strong>active()</strong> identifier to set the running state. Our updated constructor will look like this.</p>
<pre><code class="lang-csharp">CabbageStepper::CabbageStepper (CabbageGUIType &amp;cAttr, CabbagePluginAudioProcessorEditor* _owner)
        : Component(), 
        owner(_owner),
        name(cAttr.getStringProp(CabbageIDs::name)),
        channel(cAttr.getStringProp(CabbageIDs::channel)),
        colour(Colour::fromString(cAttr.getStringProp(CabbageIDs::colour))),
        stepBPM(cAttr.getNumProp(&quot;stepbpm&quot;)),
        numberOfSteps(cAttr.getNumProp(&quot;numberofsteps&quot;)),
        currentStep(0),
        isRunning(cAttr.getNumProp(CabbageIDs::active)==1 ? true : false)
{
    for(int i = 0; i &lt; numberOfSteps;i++ )
        stepStates.add(0);

    startTimer((60.f/stepBPM)*1000.f);
}
</code></pre>
<p>And our new <strong>update()</strong> function will now look like this.</p>
<pre><code class="lang-csharp">void CabbageStepper::update(CabbageGUIType cAttr)
{
    if(cAttr.getNumProp(&quot;stepbpm&quot;)!=stepBPM)
    {
        stepBPM = cAttr.getNumProp(&quot;stepbpm&quot;);
    }

    if(cAttr.getNumProp(CabbageIDs::active)!=isRunning)
    {
        isRunning = cAttr.getNumProp(CabbageIDs::active);
        if(isRunning==1)
            startTimer((60.f/stepBPM)*1000.f);
        else
            stopTimer();
    }

    if(colour.toString()!=cAttr.getStringProp(&quot;colour&quot;))
        colour = Colour::fromString(cAttr.getStringProp(&quot;colour&quot;));
}
</code></pre>
<h3 id="putting-it-all-together">Putting it all together</h3>
<p>Now that we have a way to turn on and off our widget we can create a more musically interesting instrument. We can for example stack several stepper widgets on top of each to create a simple grid sequencer. Below is a simple instrument demonstrating this. It uses a simple User Defined Opcode to enable and disable the steppers, but everything else is kept as simple as possible. </p>
<pre><code class="lang-csharp">&lt;Cabbage&gt;
<span class="hljs-function">form <span class="hljs-title">size</span><span class="hljs-params">(<span class="hljs-number">500</span>, <span class="hljs-number">430</span>)</span>, <span class="hljs-title">caption</span><span class="hljs-params">(<span class="hljs-string">&quot;Stepper&quot;</span>)</span>, <span class="hljs-title">pluginID</span><span class="hljs-params">(<span class="hljs-string">&quot;plu1&quot;</span>)</span>, <span class="hljs-title">colour</span><span class="hljs-params">(<span class="hljs-number">57</span>, <span class="hljs-number">110</span>, <span class="hljs-number">185</span>)</span>
button <span class="hljs-title">bounds</span><span class="hljs-params">(<span class="hljs-number">178</span>, <span class="hljs-number">345</span>, <span class="hljs-number">135</span>, <span class="hljs-number">31</span>)</span>, <span class="hljs-title">channel</span><span class="hljs-params">(<span class="hljs-string">&quot;startButton&quot;</span>)</span>, colour:1<span class="hljs-params">(<span class="hljs-string">&quot;lime&quot;</span>)</span>, <span class="hljs-title">text</span><span class="hljs-params">(<span class="hljs-string">&quot;Start&quot;</span>, <span class="hljs-string">&quot;Stop&quot;</span>)</span>
stepper <span class="hljs-title">bounds</span><span class="hljs-params">(<span class="hljs-number">10</span>, <span class="hljs-number">10</span>, <span class="hljs-number">480</span>, <span class="hljs-number">40</span>)</span>, <span class="hljs-title">channel</span><span class="hljs-params">(<span class="hljs-string">&quot;c4&quot;</span>)</span>, <span class="hljs-title">colour</span><span class="hljs-params">(<span class="hljs-string">&quot;white&quot;</span>)</span>, <span class="hljs-title">numberofsteps</span><span class="hljs-params">(<span class="hljs-number">12</span>)</span>, <span class="hljs-title">stepbpm</span><span class="hljs-params">(<span class="hljs-number">120</span>)</span>,  <span class="hljs-title">active</span><span class="hljs-params">(<span class="hljs-number">0</span>)</span>, <span class="hljs-title">identchannel</span><span class="hljs-params">(<span class="hljs-string">&quot;stepIdent1&quot;</span>)</span> 
stepper <span class="hljs-title">bounds</span><span class="hljs-params">(<span class="hljs-number">10</span>, <span class="hljs-number">50</span>, <span class="hljs-number">480</span>, <span class="hljs-number">40</span>)</span>, <span class="hljs-title">channel</span><span class="hljs-params">(<span class="hljs-string">&quot;b3&quot;</span>)</span>, <span class="hljs-title">colour</span><span class="hljs-params">(<span class="hljs-string">&quot;white&quot;</span>)</span>, <span class="hljs-title">numberofsteps</span><span class="hljs-params">(<span class="hljs-number">12</span>)</span>, <span class="hljs-title">stepbpm</span><span class="hljs-params">(<span class="hljs-number">120</span>)</span>,  <span class="hljs-title">active</span><span class="hljs-params">(<span class="hljs-number">0</span>)</span>, <span class="hljs-title">identchannel</span><span class="hljs-params">(<span class="hljs-string">&quot;stepIdent2&quot;</span>)</span>
stepper <span class="hljs-title">bounds</span><span class="hljs-params">(<span class="hljs-number">10</span>, <span class="hljs-number">90</span>, <span class="hljs-number">480</span>, <span class="hljs-number">40</span>)</span>, <span class="hljs-title">channel</span><span class="hljs-params">(<span class="hljs-string">&quot;a3&quot;</span>)</span>, <span class="hljs-title">colour</span><span class="hljs-params">(<span class="hljs-string">&quot;white&quot;</span>)</span>, <span class="hljs-title">numberofsteps</span><span class="hljs-params">(<span class="hljs-number">12</span>)</span>, <span class="hljs-title">stepbpm</span><span class="hljs-params">(<span class="hljs-number">120</span>)</span>,  <span class="hljs-title">active</span><span class="hljs-params">(<span class="hljs-number">0</span>)</span>, <span class="hljs-title">identchannel</span><span class="hljs-params">(<span class="hljs-string">&quot;stepIdent3&quot;</span>)</span>
stepper <span class="hljs-title">bounds</span><span class="hljs-params">(<span class="hljs-number">10</span>, <span class="hljs-number">130</span>, <span class="hljs-number">480</span>, <span class="hljs-number">40</span>)</span>, <span class="hljs-title">channel</span><span class="hljs-params">(<span class="hljs-string">&quot;g3&quot;</span>)</span>, <span class="hljs-title">colour</span><span class="hljs-params">(<span class="hljs-string">&quot;white&quot;</span>)</span>, <span class="hljs-title">numberofsteps</span><span class="hljs-params">(<span class="hljs-number">12</span>)</span>, <span class="hljs-title">stepbpm</span><span class="hljs-params">(<span class="hljs-number">120</span>)</span>, <span class="hljs-title">active</span><span class="hljs-params">(<span class="hljs-number">0</span>)</span>, <span class="hljs-title">identchannel</span><span class="hljs-params">(<span class="hljs-string">&quot;stepIdent4&quot;</span>)</span>
stepper <span class="hljs-title">bounds</span><span class="hljs-params">(<span class="hljs-number">10</span>, <span class="hljs-number">170</span>, <span class="hljs-number">480</span>, <span class="hljs-number">40</span>)</span>, <span class="hljs-title">channel</span><span class="hljs-params">(<span class="hljs-string">&quot;f3&quot;</span>)</span>, <span class="hljs-title">colour</span><span class="hljs-params">(<span class="hljs-string">&quot;white&quot;</span>)</span>, <span class="hljs-title">numberofsteps</span><span class="hljs-params">(<span class="hljs-number">12</span>)</span>, <span class="hljs-title">stepbpm</span><span class="hljs-params">(<span class="hljs-number">120</span>)</span>, <span class="hljs-title">active</span><span class="hljs-params">(<span class="hljs-number">0</span>)</span>, <span class="hljs-title">identchannel</span><span class="hljs-params">(<span class="hljs-string">&quot;stepIdent5&quot;</span>)</span>
stepper <span class="hljs-title">bounds</span><span class="hljs-params">(<span class="hljs-number">10</span>, <span class="hljs-number">210</span>, <span class="hljs-number">480</span>, <span class="hljs-number">40</span>)</span>, <span class="hljs-title">channel</span><span class="hljs-params">(<span class="hljs-string">&quot;e3&quot;</span>)</span>, <span class="hljs-title">colour</span><span class="hljs-params">(<span class="hljs-string">&quot;white&quot;</span>)</span>, <span class="hljs-title">numberofsteps</span><span class="hljs-params">(<span class="hljs-number">12</span>)</span>, <span class="hljs-title">stepbpm</span><span class="hljs-params">(<span class="hljs-number">120</span>)</span>, <span class="hljs-title">active</span><span class="hljs-params">(<span class="hljs-number">0</span>)</span>, <span class="hljs-title">identchannel</span><span class="hljs-params">(<span class="hljs-string">&quot;stepIdent6&quot;</span>)</span>
stepper <span class="hljs-title">bounds</span><span class="hljs-params">(<span class="hljs-number">10</span>, <span class="hljs-number">250</span>, <span class="hljs-number">480</span>, <span class="hljs-number">40</span>)</span>, <span class="hljs-title">channel</span><span class="hljs-params">(<span class="hljs-string">&quot;d3&quot;</span>)</span>, <span class="hljs-title">colour</span><span class="hljs-params">(<span class="hljs-string">&quot;white&quot;</span>)</span>, <span class="hljs-title">numberofsteps</span><span class="hljs-params">(<span class="hljs-number">12</span>)</span>, <span class="hljs-title">stepbpm</span><span class="hljs-params">(<span class="hljs-number">120</span>)</span>, <span class="hljs-title">active</span><span class="hljs-params">(<span class="hljs-number">0</span>)</span>, <span class="hljs-title">identchannel</span><span class="hljs-params">(<span class="hljs-string">&quot;stepIdent7&quot;</span>)</span>
stepper <span class="hljs-title">bounds</span><span class="hljs-params">(<span class="hljs-number">10</span>, <span class="hljs-number">290</span>, <span class="hljs-number">480</span>, <span class="hljs-number">40</span>)</span>, <span class="hljs-title">channel</span><span class="hljs-params">(<span class="hljs-string">&quot;c3&quot;</span>)</span>, <span class="hljs-title">colour</span><span class="hljs-params">(<span class="hljs-string">&quot;white&quot;</span>)</span>, <span class="hljs-title">numberofsteps</span><span class="hljs-params">(<span class="hljs-number">12</span>)</span>, <span class="hljs-title">stepbpm</span><span class="hljs-params">(<span class="hljs-number">120</span>)</span>, <span class="hljs-title">active</span><span class="hljs-params">(<span class="hljs-number">0</span>)</span>, <span class="hljs-title">identchannel</span><span class="hljs-params">(<span class="hljs-string">&quot;stepIdent8&quot;</span>)</span>

rslider <span class="hljs-title">bounds</span><span class="hljs-params">(<span class="hljs-number">12</span>, <span class="hljs-number">340</span>, <span class="hljs-number">80</span>, <span class="hljs-number">80</span>)</span>, <span class="hljs-title">channel</span><span class="hljs-params">(<span class="hljs-string">&quot;bpm&quot;</span>)</span>, <span class="hljs-title">range</span><span class="hljs-params">(<span class="hljs-number">40</span>, <span class="hljs-number">180</span>, <span class="hljs-number">60</span>)</span>, <span class="hljs-title">text</span><span class="hljs-params">(<span class="hljs-string">&quot;BPM&quot;</span>)</span>, <span class="hljs-title">trackercolour</span><span class="hljs-params">(<span class="hljs-string">&quot;lime&quot;</span>)</span>
rslider <span class="hljs-title">bounds</span><span class="hljs-params">(<span class="hljs-number">92</span>, <span class="hljs-number">340</span>, <span class="hljs-number">80</span>, <span class="hljs-number">80</span>)</span>, <span class="hljs-title">channel</span><span class="hljs-params">(<span class="hljs-string">&quot;gain&quot;</span>)</span>, <span class="hljs-title">range</span><span class="hljs-params">(<span class="hljs-number">0</span>, <span class="hljs-number">.7</span>, <span class="hljs-number">.5</span>)</span>, <span class="hljs-title">text</span><span class="hljs-params">(<span class="hljs-string">&quot;Gain&quot;</span>)</span>, <span class="hljs-title">trackercolour</span><span class="hljs-params">(<span class="hljs-string">&quot;lime&quot;</span>)</span>

&lt;/Cabbage&gt;
&lt;CsoundSynthesizer&gt;
&lt;CsOptions&gt; 
-m0d
&lt;/CsOptions&gt;
&lt;CsInstruments&gt;
sr </span>= <span class="hljs-number">44100</span>
ksmps = <span class="hljs-number">16</span>
nchnls = <span class="hljs-number">2</span>
<span class="hljs-number">0</span>dbfs=<span class="hljs-number">1</span>

opcode controlSteppers, k, kk
    kStart, kBPM xin
    SMessage sprintfk <span class="hljs-string">&quot;stepbpm(%d), active(%d)&quot;</span>, kBPM, kStart
    chnset SMessage, <span class="hljs-string">&quot;stepIdent1&quot;</span>
    chnset SMessage, <span class="hljs-string">&quot;stepIdent2&quot;</span>
    chnset SMessage, <span class="hljs-string">&quot;stepIdent3&quot;</span>
    chnset SMessage, <span class="hljs-string">&quot;stepIdent4&quot;</span>
    chnset SMessage, <span class="hljs-string">&quot;stepIdent5&quot;</span>
    chnset SMessage, <span class="hljs-string">&quot;stepIdent6&quot;</span>
    chnset SMessage, <span class="hljs-string">&quot;stepIdent7&quot;</span>
    chnset SMessage, <span class="hljs-string">&quot;stepIdent8&quot;</span>
xout kStart
endop


;main instrument
instr <span class="hljs-number">1</span>
    ;check <span class="hljs-keyword">if</span> user has pressed the start button
    kStartStop chnget <span class="hljs-string">&quot;startButton&quot;</span>
    kTempo chnget <span class="hljs-string">&quot;bpm&quot;</span>
    <span class="hljs-keyword">if</span> changed:k(kStartStop)==<span class="hljs-number">1</span> || changed:k(kTempo)==<span class="hljs-number">1</span> then
        <span class="hljs-keyword">if</span> chnget:k(<span class="hljs-string">&quot;startButton&quot;</span>)==<span class="hljs-number">1</span> then
            k1 controlSteppers <span class="hljs-number">1</span>, kTempo
        <span class="hljs-keyword">else</span>
            k1 controlSteppers <span class="hljs-number">0</span>, kTempo
        endif
    endif

    ;trigger notes according to which steps are activated
    <span class="hljs-keyword">if</span> changed:k(chnget:k(<span class="hljs-string">&quot;c4&quot;</span>))==<span class="hljs-number">1</span> &amp;&amp; chnget:k(<span class="hljs-string">&quot;c4&quot;</span>)!=<span class="hljs-number">0</span> then
        <span class="hljs-keyword">event</span> <span class="hljs-string">&quot;i&quot;</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>, <span class="hljs-number">3</span>, cpsmidinn(<span class="hljs-number">72</span>)
    elseif changed:k(chnget:k(<span class="hljs-string">&quot;b3&quot;</span>))==<span class="hljs-number">1</span> &amp;&amp; chnget:k(<span class="hljs-string">&quot;b3&quot;</span>)!=<span class="hljs-number">0</span> then
        <span class="hljs-keyword">event</span> <span class="hljs-string">&quot;i&quot;</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>, <span class="hljs-number">3</span>, cpsmidinn(<span class="hljs-number">71</span>)
    elseif changed:k(chnget:k(<span class="hljs-string">&quot;a3&quot;</span>))==<span class="hljs-number">1</span> &amp;&amp; chnget:k(<span class="hljs-string">&quot;a3&quot;</span>)!=<span class="hljs-number">0</span> then
        <span class="hljs-keyword">event</span> <span class="hljs-string">&quot;i&quot;</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>, <span class="hljs-number">3</span>, cpsmidinn(<span class="hljs-number">69</span>)
    elseif changed:k(chnget:k(<span class="hljs-string">&quot;g3&quot;</span>))==<span class="hljs-number">1</span> &amp;&amp; chnget:k(<span class="hljs-string">&quot;g3&quot;</span>)!=<span class="hljs-number">0</span> then
        <span class="hljs-keyword">event</span> <span class="hljs-string">&quot;i&quot;</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>, <span class="hljs-number">3</span>, cpsmidinn(<span class="hljs-number">67</span>)
    elseif changed:k(chnget:k(<span class="hljs-string">&quot;f3&quot;</span>))==<span class="hljs-number">1</span> &amp;&amp; chnget:k(<span class="hljs-string">&quot;f3&quot;</span>)!=<span class="hljs-number">0</span> then
        <span class="hljs-keyword">event</span> <span class="hljs-string">&quot;i&quot;</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>, <span class="hljs-number">3</span>, cpsmidinn(<span class="hljs-number">65</span>)
    elseif changed:k(chnget:k(<span class="hljs-string">&quot;e3&quot;</span>))==<span class="hljs-number">1</span> &amp;&amp; chnget:k(<span class="hljs-string">&quot;e3&quot;</span>)!=<span class="hljs-number">0</span> then
        <span class="hljs-keyword">event</span> <span class="hljs-string">&quot;i&quot;</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>, <span class="hljs-number">3</span>, cpsmidinn(<span class="hljs-number">64</span>)
    elseif changed:k(chnget:k(<span class="hljs-string">&quot;d3&quot;</span>))==<span class="hljs-number">1</span> &amp;&amp; chnget:k(<span class="hljs-string">&quot;d3&quot;</span>)!=<span class="hljs-number">0</span> then
        <span class="hljs-keyword">event</span> <span class="hljs-string">&quot;i&quot;</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>, <span class="hljs-number">3</span>, cpsmidinn(<span class="hljs-number">62</span>)
    elseif changed:k(chnget:k(<span class="hljs-string">&quot;c3&quot;</span>))==<span class="hljs-number">1</span> &amp;&amp; chnget:k(<span class="hljs-string">&quot;c3&quot;</span>)!=<span class="hljs-number">0</span> then
        <span class="hljs-keyword">event</span> <span class="hljs-string">&quot;i&quot;</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>, <span class="hljs-number">3</span>, cpsmidinn(<span class="hljs-number">60</span>)
    endif

endin

;simple synthesiser 
instr <span class="hljs-number">2</span>
    print p1
    a1 expon chnget:i(<span class="hljs-string">&quot;gain&quot;</span>), p3, <span class="hljs-number">0.001</span>
    a2 oscili a1, p4
    outs a2, a2
endin

&lt;/CsInstruments&gt;  
&lt;CsScore&gt;
i1 <span class="hljs-number">0</span> <span class="hljs-number">5000</span>
&lt;/CsScore&gt;
&lt;/CsoundSynthesizer&gt;
</code></pre>
<p><img src="images/newWidgetFinished.gif" alt="NewWidget3"></p>

                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="./new_widgets_part_2.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page: Part 2"><i class="fa fa-angle-left"></i></a>
        
        
    </div>
</div>

        
<script src="gitbook/app.js"></script>

<script>
require(["gitbook"], function(gitbook) {
    var config = {"fontSettings":{"theme":null,"family":"sans","size":2}};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
